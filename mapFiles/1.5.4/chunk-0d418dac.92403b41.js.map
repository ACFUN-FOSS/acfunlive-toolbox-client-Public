{"version":3,"sources":["webpack:///./src/electron_browser/views/danmakuWeb/index.vue?500d","webpack:///./src/electron_browser/views/danmakuWeb/index.vue","webpack:///./src/electron_browser/views/danmakuWeb/index.vue?a23d","webpack:///./src/electron_browser/views/danmakuWeb/index.vue?d067","webpack:///./src/electron_browser/components/superChat/index.vue?6813","webpack:///./src/electron_browser/components/superChat/index.vue","webpack:///./src/electron_browser/components/superChat/index.vue?04c7","webpack:///./src/electron_browser/components/superChat/index.vue?0dd8"],"names":["style","class","enable","superChatEnable","settings","danmakuProfile","web","danmakuList","danmakuSession","filterFlow","name","mode","pos","key","dotsCount","dot","checkers","checker","label","value","components","flow","superChatList","superChat","statusTimer","that","this","settingTimer","reconnect","status","isOnline","method","refresh","wait","registered","registerWS","logined","login","hasSession","requestSession","hasSetting","updateSettings","hasRank","isStreaming","requestStreaming","$store","state","isLogined","registerEvents","dispatch","then","unRegisterEvents","computed","Object","values","item","methods","clearTimeout","forEach","window","wsl","close","on","updateSession","updateRank","updateManager","checkServerState","off","Promise","resolve","account","password","streamStatus","step","statusLooper","startDanmaku","location","reload","next","time","setTimeout","res","finally","register","userSession","userID","wsEmit","Boolean","liveID","fetch","cache","json","common","temp","session","rank","managerList","list","length","push","mock","liverUID","type","data","danmuInfo","sendTime","userInfo","nickname","avatar","medal","uperID","clubName","level","managerType","content","i","render","superChatArray","scBlock","selectedID","superChatID","select","displayType","uid","sc-block","currentTime","remove","superChatBlock","listBlock","listPanel","timeCounter","count","update","Date","now","nextOne","find","block","showed","listEndTime","panelEndTime","filter","blockI","__scopeId"],"mappings":"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","file":"js/chunk-0d418dac.92403b41.js","sourcesContent":["export * from \"-!../../../../node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./index.vue?vue&type=style&index=0&id=17eeece3&lang=scss\"","<template>\n\t<div style=\"width:100%;height:100%;position:relative\">\n\t\t<super-chat-list class=\"super-chat\" v-if=\"enable&&superChatEnable\" />\n\t\t<flow v-if=\"enable\" :class=\"{superChatEnable}\" :settings=\"danmakuProfile.web\" :danmakuList=\"danmakuSession.filterFlow\" />\n\t\t<transition name=\"fade\" mode=\"out-in\">\n\t\t\t<div class=\"tips\" v-if=\"!enable\">\n\t\t\t\t<div class=\"positioner\" :class=\"pos\" v-for=\"pos in ['lt','rt','lb','rb']\" :key=\"pos\" />\n\t\t\t\t<div class=\"title\">弹幕准备中。<span v-for=\"dot in dotsCount\" :key=\"dot\">。</span></div>\n\t\t\t\t<div v-for=\"checker of checkers\" :key=\"checker.label\" class=\"checkers\">\n\t\t\t\t\t<div class=\"label\">{{checker.label}}</div>\n\t\t\t\t\t<div class=\"status\" :class=\"checker.value?'el-icon-circle-check success':'el-icon-circle-close failed'\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</transition>\n\t</div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nimport { wsevent, user, server } from \"@front/api\";\nimport { event } from \"@front/util_function/eventBus\";\nimport { commonSettings } from \"@front/datas/danmaku\";\nimport { tempInfo } from \"@front/datas/temp\";\nimport flow from \"@front/components/danmakuFlow/index.vue\";\nimport { mapState, mapGetters } from \"vuex\";\nimport superChatList from \"@front/components/superChat/index.vue\";\nimport { registerRole } from \"@front/util_function/base\";\nimport { actions } from \"@front/store/actions\";\nexport default defineComponent({\n\tname: \"webDanmaku\",\n\tcomponents: {\n\t\tflow,\n\t\tsuperChatList\n\t},\n\tdata() {\n\t\tconst danmakuList: any = [];\n\t\tconst statusTimer: any = null;\n\t\t// @ts-ignore\n\t\tconst that: any = this;\n\t\treturn {\n\t\t\tdanmakuList,\n\t\t\tstatusTimer,\n\t\t\tsettingTimer: false,\n\t\t\tdotsCount: 0,\n\t\t\treconnect: false,\n\t\t\tstatus: {\n\t\t\t\tisOnline: {\n\t\t\t\t\tlabel: \"连接在线\",\n\t\t\t\t\tmethod: that.refresh,\n\t\t\t\t\tvalue: false,\n\t\t\t\t\twait: 2000\n\t\t\t\t},\n\t\t\t\tregistered: {\n\t\t\t\t\tlabel: \"通信注册\",\n\t\t\t\t\tmethod: that.registerWS,\n\t\t\t\t\tvalue: false,\n\t\t\t\t\twait: 500\n\t\t\t\t},\n\t\t\t\tlogined: {\n\t\t\t\t\tlabel: \"登陆\",\n\t\t\t\t\tmethod: that.login,\n\t\t\t\t\tvalue: false,\n\t\t\t\t\twait: 1500\n\t\t\t\t},\n\t\t\t\thasSession: {\n\t\t\t\t\tlabel: \"主播信息\",\n\t\t\t\t\tmethod: that.requestSession,\n\t\t\t\t\tvalue: false,\n\t\t\t\t\twait: 500\n\t\t\t\t},\n\t\t\t\thasSetting: {\n\t\t\t\t\tlabel: \"弹幕设置\",\n\t\t\t\t\tmethod: that.updateSettings,\n\t\t\t\t\tvalue: false,\n\t\t\t\t\twait: 1500\n\t\t\t\t},\n\t\t\t\thasRank: {\n\t\t\t\t\tlabel: \"牌子信息\",\n\t\t\t\t\tvalue: false,\n\t\t\t\t\twait: 500\n\t\t\t\t},\n\t\t\t\tisStreaming: {\n\t\t\t\t\tlabel: \"直播启动\",\n\t\t\t\t\tmethod: that.requestStreaming,\n\t\t\t\t\tvalue: false,\n\t\t\t\t\twait: 500\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t},\n\tcreated() {\n\t\tthis.$store.state.isLogined = true;\n\t\tthis.registerEvents();\n\t},\n\tmounted() {\n\t\tthis.$store.dispatch(\"startServe\").then(() => {\n\t\t\tthis.registerWS();\n\t\t});\n\t\tregisterRole(\"网页端\");\n\t},\n\tbeforeUnmount() {\n\t\tthis.unRegisterEvents();\n\t},\n\tcomputed: {\n\t\t...mapGetters([\"superChatEnable\"]),\n\t\t...mapState([\n\t\t\t\"userSession\",\n\t\t\t\"danmakuProfile\",\n\t\t\t\"rank\",\n\t\t\t\"streamStatus\",\n\t\t\t\"danmakuSession\"\n\t\t]),\n\t\tcheckers(): Array<any> {\n\t\t\treturn Object.values(this.status);\n\t\t},\n\t\tenable(): boolean {\n\t\t\tfor (const item of Object.values(this.status)) {\n\t\t\t\tif (!item.value) return false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t},\n\tmethods: {\n\t\trefresh() {\n\t\t\tclearTimeout(this.statusTimer);\n\t\t\tthis.checkers.forEach((checker: any) => {\n\t\t\t\tchecker.value = false;\n\t\t\t});\n\t\t\tif (server.isOnline()) {\n\t\t\t\t// @ts-ignore\n\t\t\t\twindow.wsl.close();\n\t\t\t}\n\t\t},\n\t\tregisterEvents() {\n\t\t\twsevent.on(\"update-style\", this.updateSettings);\n\t\t\twsevent.on(\"update-settings\", this.updateSettings);\n\t\t\twsevent.on(\"update-session\", this.updateSession); // rank 由服务器定期发送\n\t\t\twsevent.on(\"update-rank\", this.updateRank);\n\t\t\twsevent.on(\"update-manager\", this.updateManager);\n\t\t\twsevent.on(\"registered\", () => {\n\t\t\t\tthis.status.registered.value = true;\n\t\t\t});\n\t\t\tevent.on(\"streamStatusChanged\", this.checkServerState);\n\t\t},\n\t\tunRegisterEvents() {\n\t\t\twsevent.off(\"update-style\", this.updateSettings);\n\t\t\twsevent.off(\"update-settings\", this.updateSettings);\n\t\t\twsevent.off(\"update-session\", this.updateSession); // rank 由服务器定期发送\n\t\t\twsevent.off(\"update-rank\", this.updateRank);\n\t\t\twsevent.off(\"update-manager\", this.updateManager);\n\t\t\tevent.off(\"streamStatusChanged\", this.checkServerState);\n\t\t},\n\t\tlogin() {\n\t\t\treturn new Promise(resolve => {\n\t\t\t\tuser.login({\n\t\t\t\t\taccount: \"\",\n\t\t\t\t\tpassword: \"\"\n\t\t\t\t}).then(() => {\n\t\t\t\t\tthis.status.logined.value = true;\n\t\t\t\t\tthis.registerWS();\n\t\t\t\t\tresolve(true);\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tcheckServerState() {\n\t\t\tswitch (this.streamStatus.step) {\n\t\t\t\tcase \"online\":\n\t\t\t\t\tthis.status.isOnline.value = true;\n\t\t\t\t\tthis.registerWS();\n\t\t\t\t\tthis.statusLooper();\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"danmakuing\":\n\t\t\t\t\tthis.startDanmaku();\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"streamEnded\":\n\t\t\t\t\twindow.location.reload();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\t\tstatusLooper() {\n\t\t\tclearTimeout(this.statusTimer);\n\t\t\tthis.dotsCount = (this.dotsCount + 1) % 4;\n\t\t\tconst next = (time = 500) => {\n\t\t\t\tthis.statusTimer = setTimeout(() => {\n\t\t\t\t\tthis.statusLooper();\n\t\t\t\t}, time);\n\t\t\t};\n\t\t\tfor (const checker of this.checkers) {\n\t\t\t\tif (!checker.value) {\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\tif (checker.method) {\n\t\t\t\t\t\tconst res = checker.method();\n\t\t\t\t\t\tif (res instanceof Promise) {\n\t\t\t\t\t\t\tres.finally(() => {\n\t\t\t\t\t\t\t\tnext();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnext(checker.wait);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnext();\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tregisterWS() {\n\t\t\twsevent.register(\"client\");\n\t\t},\n\t\trequestSession() {\n\t\t\tif (!this.userSession.userID) {\n\t\t\t\twsevent.wsEmit(\"get-session\", {}, \"server\");\n\t\t\t} else {\n\t\t\t\tthis.status.hasSetting.value = true;\n\t\t\t}\n\t\t},\n\t\trequestSettings() {\n\t\t\twsevent.wsEmit(\"get-settings\", {}, \"server\");\n\t\t},\n\t\trequestStreaming() {\n\t\t\treturn this.$store.dispatch(\"streamable\").then((res: any) => {\n\t\t\t\tthis.status.isStreaming.value = Boolean(res.liveID);\n\t\t\t});\n\t\t},\n\t\tupdateSettings() {\n\t\t\tif (this.settingTimer) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.settingTimer = true;\n\t\t\tfetch(\"/configFiles/config.json\", {\n\t\t\t\tcache: \"no-cache\"\n\t\t\t})\n\t\t\t\t.then((res: any) => res.json())\n\t\t\t\t.then((json: any) => {\n\t\t\t\t\tthis.status.hasSetting.value = true;\n\t\t\t\t\tthis.$store.state.danmakuProfile.web = json.web;\n\t\t\t\t\tthis.$store.state.danmakuProfile.common =\n\t\t\t\t\t\tjson.common || commonSettings();\n\t\t\t\t\tthis.$store.state.temp = tempInfo();\n\t\t\t\t})\n\t\t\t\t.finally(() => {\n\t\t\t\t\tthis.settingTimer = false;\n\t\t\t\t});\n\t\t},\n\t\tupdateSession(session: any) {\n\t\t\tif (\n\t\t\t\tthis.status.hasSession.value &&\n\t\t\t\tthis.userSession.userID !== session.userID\n\t\t\t) {\n\t\t\t\tthis.refresh();\n\t\t\t}\n\t\t\tif ((this.status.hasSession.value = Boolean(session))) {\n\t\t\t\tthis.$store.state.userSession = session;\n\t\t\t}\n\t\t},\n\t\tupdateRank(rank: any) {\n\t\t\tif ((this.status.hasRank.value = Boolean(rank))) {\n\t\t\t\tthis.$store.state.rank = rank;\n\t\t\t}\n\t\t},\n\t\tupdateManager(res: any) {\n\t\t\tthis.$store.state.managerList = res.list;\n\t\t},\n\t\tstartDanmaku() {\n\t\t\tif (!this.danmakuSession.filterFlow.length) {\n\t\t\t\tthis.danmakuSession.filterFlow.push({\n\t\t\t\t\tmock: true,\n\t\t\t\t\tliverUID: 23682490,\n\t\t\t\t\ttype: 1000,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tdanmuInfo: {\n\t\t\t\t\t\t\tsendTime: 1618750176864,\n\t\t\t\t\t\t\tuserInfo: {\n\t\t\t\t\t\t\t\tuserID: 1,\n\t\t\t\t\t\t\t\tnickname: \"ACFUN前后端开源⑨课\",\n\t\t\t\t\t\t\t\tavatar:\n\t\t\t\t\t\t\t\t\t\"https://tx-free-imgs.acfun.cn/FllI0yyjNgQ61QdJJdbIh9cRQIYY?imageMogr2/auto-orient/format/webp/quality/75!/ignore-error/1\",\n\t\t\t\t\t\t\t\tmedal: {\n\t\t\t\t\t\t\t\t\tuperID: 23682490,\n\t\t\t\t\t\t\t\t\tuserID: 1,\n\t\t\t\t\t\t\t\t\tclubName: \"ACER\",\n\t\t\t\t\t\t\t\t\tlevel: 999\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tmanagerType: 0\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcontent: \"弹幕流启动成功！直播开始啦开始啦！\"\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\treWait() {\n\t\t\t[\"hasSession\", \"isStreaming\", \"hasRank\", \"danmakuing\"].forEach(\n\t\t\t\t(i: any) => {\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\tthis.status[i].value = false;\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n});\n</script>\n<style lang='scss'>\n@import \"@front/styles/variables.scss\";\nhtml,\nbody,\n#app {\n\tbackground-color: transparent;\n\tmin-width: 0px;\n\tmin-height: 0px;\n\twidth: 100%;\n\theight: 100%;\n\tpadding: 0px;\n}\n#app {\n\tmargin: 0px;\n\twidth: 100%;\n\theight: 100%;\n\ttransition: none;\n}\n.danmaku-flow {\n\tpadding-bottom: 16px !important;\n}\n.superChatEnable {\n\theight: calc(100% - 40px);\n}\n.super-chat {\n\tborder: none !important;\n\tmargin-bottom: 5px;\n}\n.tips {\n\tposition: absolute;\n\twidth: 100%;\n\theight: 100%;\n\tcolor: white;\n\tbackground-color: rgba(0, 0, 0, 0.5);\n\tfont-weight: 700;\n\tfont-size: 24px;\n\tdisplay: flex;\n\tjustify-content: center;\n\tflex-direction: column;\n\talign-items: center;\n\t.title {\n\t\tfont-size: 32px;\n\t\tmargin-bottom: 15px;\n\t\tmargin-left: 50px;\n\t\twhite-space: nowrap;\n\t}\n\t.checkers {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tmargin-bottom: 15px;\n\t\t.failed {\n\t\t\tcolor: $--color-danger;\n\t\t}\n\t\t.success {\n\t\t\tcolor: $--color-success;\n\t\t}\n\t\t.label {\n\t\t\twidth: 150px;\n\t\t}\n\t}\n\t.positioner {\n\t\tposition: absolute;\n\t\tborder-style: solid;\n\t\tborder-color: white;\n\t\theight: 5%;\n\t\twidth: 5%;\n\n\t\t&.lt {\n\t\t\ttop: 0px;\n\t\t\tleft: 0px;\n\t\t\tborder-width: 5px 0px 0px 5px;\n\t\t}\n\t\t&.rt {\n\t\t\ttop: 0px;\n\t\t\tright: 0px;\n\t\t\tborder-width: 5px 5px 0px 0px;\n\t\t}\n\t\t&.lb {\n\t\t\tbottom: 0px;\n\t\t\tleft: 0px;\n\t\t\tborder-width: 0px 0px 5px 5px;\n\t\t}\n\t\t&.rb {\n\t\t\tbottom: 0px;\n\t\t\tright: 0px;\n\t\t\tborder-width: 0px 5px 5px 0px;\n\t\t}\n\t}\n}\n</style>\n","\nimport { defineComponent } from \"vue\";\nimport { wsevent, user, server } from \"@front/api\";\nimport { event } from \"@front/util_function/eventBus\";\nimport { commonSettings } from \"@front/datas/danmaku\";\nimport { tempInfo } from \"@front/datas/temp\";\nimport flow from \"@front/components/danmakuFlow/index.vue\";\nimport { mapState, mapGetters } from \"vuex\";\nimport superChatList from \"@front/components/superChat/index.vue\";\nimport { registerRole } from \"@front/util_function/base\";\nimport { actions } from \"@front/store/actions\";\nexport default defineComponent({\n\tname: \"webDanmaku\",\n\tcomponents: {\n\t\tflow,\n\t\tsuperChatList\n\t},\n\tdata() {\n\t\tconst danmakuList: any = [];\n\t\tconst statusTimer: any = null;\n\t\t// @ts-ignore\n\t\tconst that: any = this;\n\t\treturn {\n\t\t\tdanmakuList,\n\t\t\tstatusTimer,\n\t\t\tsettingTimer: false,\n\t\t\tdotsCount: 0,\n\t\t\treconnect: false,\n\t\t\tstatus: {\n\t\t\t\tisOnline: {\n\t\t\t\t\tlabel: \"连接在线\",\n\t\t\t\t\tmethod: that.refresh,\n\t\t\t\t\tvalue: false,\n\t\t\t\t\twait: 2000\n\t\t\t\t},\n\t\t\t\tregistered: {\n\t\t\t\t\tlabel: \"通信注册\",\n\t\t\t\t\tmethod: that.registerWS,\n\t\t\t\t\tvalue: false,\n\t\t\t\t\twait: 500\n\t\t\t\t},\n\t\t\t\tlogined: {\n\t\t\t\t\tlabel: \"登陆\",\n\t\t\t\t\tmethod: that.login,\n\t\t\t\t\tvalue: false,\n\t\t\t\t\twait: 1500\n\t\t\t\t},\n\t\t\t\thasSession: {\n\t\t\t\t\tlabel: \"主播信息\",\n\t\t\t\t\tmethod: that.requestSession,\n\t\t\t\t\tvalue: false,\n\t\t\t\t\twait: 500\n\t\t\t\t},\n\t\t\t\thasSetting: {\n\t\t\t\t\tlabel: \"弹幕设置\",\n\t\t\t\t\tmethod: that.updateSettings,\n\t\t\t\t\tvalue: false,\n\t\t\t\t\twait: 1500\n\t\t\t\t},\n\t\t\t\thasRank: {\n\t\t\t\t\tlabel: \"牌子信息\",\n\t\t\t\t\tvalue: false,\n\t\t\t\t\twait: 500\n\t\t\t\t},\n\t\t\t\tisStreaming: {\n\t\t\t\t\tlabel: \"直播启动\",\n\t\t\t\t\tmethod: that.requestStreaming,\n\t\t\t\t\tvalue: false,\n\t\t\t\t\twait: 500\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t},\n\tcreated() {\n\t\tthis.$store.state.isLogined = true;\n\t\tthis.registerEvents();\n\t},\n\tmounted() {\n\t\tthis.$store.dispatch(\"startServe\").then(() => {\n\t\t\tthis.registerWS();\n\t\t});\n\t\tregisterRole(\"网页端\");\n\t},\n\tbeforeUnmount() {\n\t\tthis.unRegisterEvents();\n\t},\n\tcomputed: {\n\t\t...mapGetters([\"superChatEnable\"]),\n\t\t...mapState([\n\t\t\t\"userSession\",\n\t\t\t\"danmakuProfile\",\n\t\t\t\"rank\",\n\t\t\t\"streamStatus\",\n\t\t\t\"danmakuSession\"\n\t\t]),\n\t\tcheckers(): Array<any> {\n\t\t\treturn Object.values(this.status);\n\t\t},\n\t\tenable(): boolean {\n\t\t\tfor (const item of Object.values(this.status)) {\n\t\t\t\tif (!item.value) return false;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t},\n\tmethods: {\n\t\trefresh() {\n\t\t\tclearTimeout(this.statusTimer);\n\t\t\tthis.checkers.forEach((checker: any) => {\n\t\t\t\tchecker.value = false;\n\t\t\t});\n\t\t\tif (server.isOnline()) {\n\t\t\t\t// @ts-ignore\n\t\t\t\twindow.wsl.close();\n\t\t\t}\n\t\t},\n\t\tregisterEvents() {\n\t\t\twsevent.on(\"update-style\", this.updateSettings);\n\t\t\twsevent.on(\"update-settings\", this.updateSettings);\n\t\t\twsevent.on(\"update-session\", this.updateSession); // rank 由服务器定期发送\n\t\t\twsevent.on(\"update-rank\", this.updateRank);\n\t\t\twsevent.on(\"update-manager\", this.updateManager);\n\t\t\twsevent.on(\"registered\", () => {\n\t\t\t\tthis.status.registered.value = true;\n\t\t\t});\n\t\t\tevent.on(\"streamStatusChanged\", this.checkServerState);\n\t\t},\n\t\tunRegisterEvents() {\n\t\t\twsevent.off(\"update-style\", this.updateSettings);\n\t\t\twsevent.off(\"update-settings\", this.updateSettings);\n\t\t\twsevent.off(\"update-session\", this.updateSession); // rank 由服务器定期发送\n\t\t\twsevent.off(\"update-rank\", this.updateRank);\n\t\t\twsevent.off(\"update-manager\", this.updateManager);\n\t\t\tevent.off(\"streamStatusChanged\", this.checkServerState);\n\t\t},\n\t\tlogin() {\n\t\t\treturn new Promise(resolve => {\n\t\t\t\tuser.login({\n\t\t\t\t\taccount: \"\",\n\t\t\t\t\tpassword: \"\"\n\t\t\t\t}).then(() => {\n\t\t\t\t\tthis.status.logined.value = true;\n\t\t\t\t\tthis.registerWS();\n\t\t\t\t\tresolve(true);\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tcheckServerState() {\n\t\t\tswitch (this.streamStatus.step) {\n\t\t\t\tcase \"online\":\n\t\t\t\t\tthis.status.isOnline.value = true;\n\t\t\t\t\tthis.registerWS();\n\t\t\t\t\tthis.statusLooper();\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"danmakuing\":\n\t\t\t\t\tthis.startDanmaku();\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"streamEnded\":\n\t\t\t\t\twindow.location.reload();\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\t\tstatusLooper() {\n\t\t\tclearTimeout(this.statusTimer);\n\t\t\tthis.dotsCount = (this.dotsCount + 1) % 4;\n\t\t\tconst next = (time = 500) => {\n\t\t\t\tthis.statusTimer = setTimeout(() => {\n\t\t\t\t\tthis.statusLooper();\n\t\t\t\t}, time);\n\t\t\t};\n\t\t\tfor (const checker of this.checkers) {\n\t\t\t\tif (!checker.value) {\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\tif (checker.method) {\n\t\t\t\t\t\tconst res = checker.method();\n\t\t\t\t\t\tif (res instanceof Promise) {\n\t\t\t\t\t\t\tres.finally(() => {\n\t\t\t\t\t\t\t\tnext();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnext(checker.wait);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnext();\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tregisterWS() {\n\t\t\twsevent.register(\"client\");\n\t\t},\n\t\trequestSession() {\n\t\t\tif (!this.userSession.userID) {\n\t\t\t\twsevent.wsEmit(\"get-session\", {}, \"server\");\n\t\t\t} else {\n\t\t\t\tthis.status.hasSetting.value = true;\n\t\t\t}\n\t\t},\n\t\trequestSettings() {\n\t\t\twsevent.wsEmit(\"get-settings\", {}, \"server\");\n\t\t},\n\t\trequestStreaming() {\n\t\t\treturn this.$store.dispatch(\"streamable\").then((res: any) => {\n\t\t\t\tthis.status.isStreaming.value = Boolean(res.liveID);\n\t\t\t});\n\t\t},\n\t\tupdateSettings() {\n\t\t\tif (this.settingTimer) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.settingTimer = true;\n\t\t\tfetch(\"/configFiles/config.json\", {\n\t\t\t\tcache: \"no-cache\"\n\t\t\t})\n\t\t\t\t.then((res: any) => res.json())\n\t\t\t\t.then((json: any) => {\n\t\t\t\t\tthis.status.hasSetting.value = true;\n\t\t\t\t\tthis.$store.state.danmakuProfile.web = json.web;\n\t\t\t\t\tthis.$store.state.danmakuProfile.common =\n\t\t\t\t\t\tjson.common || commonSettings();\n\t\t\t\t\tthis.$store.state.temp = tempInfo();\n\t\t\t\t})\n\t\t\t\t.finally(() => {\n\t\t\t\t\tthis.settingTimer = false;\n\t\t\t\t});\n\t\t},\n\t\tupdateSession(session: any) {\n\t\t\tif (\n\t\t\t\tthis.status.hasSession.value &&\n\t\t\t\tthis.userSession.userID !== session.userID\n\t\t\t) {\n\t\t\t\tthis.refresh();\n\t\t\t}\n\t\t\tif ((this.status.hasSession.value = Boolean(session))) {\n\t\t\t\tthis.$store.state.userSession = session;\n\t\t\t}\n\t\t},\n\t\tupdateRank(rank: any) {\n\t\t\tif ((this.status.hasRank.value = Boolean(rank))) {\n\t\t\t\tthis.$store.state.rank = rank;\n\t\t\t}\n\t\t},\n\t\tupdateManager(res: any) {\n\t\t\tthis.$store.state.managerList = res.list;\n\t\t},\n\t\tstartDanmaku() {\n\t\t\tif (!this.danmakuSession.filterFlow.length) {\n\t\t\t\tthis.danmakuSession.filterFlow.push({\n\t\t\t\t\tmock: true,\n\t\t\t\t\tliverUID: 23682490,\n\t\t\t\t\ttype: 1000,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tdanmuInfo: {\n\t\t\t\t\t\t\tsendTime: 1618750176864,\n\t\t\t\t\t\t\tuserInfo: {\n\t\t\t\t\t\t\t\tuserID: 1,\n\t\t\t\t\t\t\t\tnickname: \"ACFUN前后端开源⑨课\",\n\t\t\t\t\t\t\t\tavatar:\n\t\t\t\t\t\t\t\t\t\"https://tx-free-imgs.acfun.cn/FllI0yyjNgQ61QdJJdbIh9cRQIYY?imageMogr2/auto-orient/format/webp/quality/75!/ignore-error/1\",\n\t\t\t\t\t\t\t\tmedal: {\n\t\t\t\t\t\t\t\t\tuperID: 23682490,\n\t\t\t\t\t\t\t\t\tuserID: 1,\n\t\t\t\t\t\t\t\t\tclubName: \"ACER\",\n\t\t\t\t\t\t\t\t\tlevel: 999\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tmanagerType: 0\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcontent: \"弹幕流启动成功！直播开始啦开始啦！\"\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\treWait() {\n\t\t\t[\"hasSession\", \"isStreaming\", \"hasRank\", \"danmakuing\"].forEach(\n\t\t\t\t(i: any) => {\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\tthis.status[i].value = false;\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n});\n","import { render } from \"./index.vue?vue&type=template&id=17eeece3\"\nimport script from \"./index.vue?vue&type=script&lang=ts\"\nexport * from \"./index.vue?vue&type=script&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=17eeece3&lang=scss\"\nscript.render = render\n\nexport default script","export * from \"-!../../../../node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./index.vue?vue&type=style&index=0&id=3c0b1be0&scoped=true&lang=scss\"","<template>\n\t<div class=\"super-chat-list\">\n\t\t<div class=\"super-chat-list-row\">\n\t\t\t<list-block :selectedID=\"temp.superChatID\" @click=\"select(scBlock,5000)\" :displayType=\"displayType\" v-for=\"scBlock in temp.superChatArray\" :key=\"scBlock.uid\" :sc-block=\"scBlock\" :currentTime=\"currentTime\" @end=\"remove(scBlock)\" />\n\t\t</div>\n\t\t<transition name=\"fade\" mode=\"out-in\">\n\t\t\t<list-panel class=\"super-chat-panel\" :displayType=\"displayType\" :key=\"temp.superChatID\" v-if=\"temp.superChatBlock\" :sc-block=\"temp.superChatBlock\" :currentTime=\"currentTime\" @next=\"next()\" />\n\t\t</transition>\n\t</div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nimport { mapState } from \"vuex\";\nimport listBlock from \"./listBlock.vue\";\nimport listPanel from \"./listPanel.vue\";\nimport { event } from \"@front/util_function/eventBus\";\nexport default defineComponent({\n\tname: \"superChatList\",\n\tcomponents: { listBlock, listPanel },\n\tdata() {\n\t\tconst timeCounter: any = null;\n\t\treturn {\n\t\t\tcurrentTime: 0,\n\t\t\ttimeCounter\n\t\t};\n\t},\n\tmounted() {\n\t\tthis.count();\n\t\tevent.on(\"super-chat-updated\", this.update);\n\t},\n\tbeforeUnmount() {\n\t\tclearTimeout(this.timeCounter);\n\t\tevent.off(\"super-chat-updated\", this.update);\n\t},\n\tcomputed: {\n\t\t...mapState([\"temp\", \"danmakuProfile\"]),\n\t\tsuperChatArray(): Array<any> {\n\t\t\treturn this.temp.superChatArray;\n\t\t},\n\t\tdisplayType(): number {\n\t\t\treturn this.danmakuProfile.common?.superChat?.displayType || 0;\n\t\t}\n\t},\n\tmethods: {\n\t\tupdate() {\n\t\t\tif (this.temp.superChatID) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.next();\n\t\t},\n\t\tcount() {\n\t\t\tclearTimeout(this.timeCounter);\n\t\t\tthis.currentTime = Date.now();\n\t\t\tthis.timeCounter = setTimeout(() => {\n\t\t\t\tthis.count();\n\t\t\t}, 1000);\n\t\t},\n\t\tnext() {\n\t\t\tconst nextOne = this.temp.superChatArray.find(\n\t\t\t\t(block: any) => !block?.showed\n\t\t\t);\n\t\t\tif (\n\t\t\t\t!nextOne &&\n\t\t\t\tthis.currentTime > this.temp.superChatBlock.listEndTime\n\t\t\t) {\n\t\t\t\tthis.temp.superChatID = 0;\n\t\t\t\tthis.temp.superChatBlock = false;\n\t\t\t} else {\n\t\t\t\tthis.select(nextOne);\n\t\t\t}\n\t\t},\n\t\tselect(block: any, time = 20000) {\n\t\t\tblock.showed = true;\n\t\t\tblock.panelEndTime = Date.now() + time;\n\t\t\tif (block.listEndTime < block.panelEndTime) {\n\t\t\t\tblock.listEndTime = block.panelEndTime;\n\t\t\t}\n\t\t\tthis.temp.superChatID = block.uid;\n\t\t\tthis.temp.superChatBlock = block;\n\t\t},\n\t\tremove(block: any) {\n\t\t\tthis.temp.superChatArray = this.temp.superChatArray.filter(\n\t\t\t\t(blockI: any) => blockI !== block\n\t\t\t);\n\t\t\tif (block.uid === this.temp.superChatID) {\n\t\t\t\tthis.next();\n\t\t\t}\n\t\t}\n\t}\n});\n</script>\n\n<style scoped lang='scss'>\n@import \"@front/styles/variables.scss\";\n.super-chat-list {\n\tposition: relative;\n\twidth: 100%;\n\theight: 35px;\n\tbox-sizing: border-box;\n\tborder: $--border-base;\n\t.super-chat-list-row {\n\t\tposition: absolute;\n\t\twidth: 100%;\n\t\theight: 100%;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tflex-wrap: wrap;\n\t\toverflow: hidden;\n\t\tpadding-left: 8px;\n\t}\n}\n</style>\n","\nimport { defineComponent } from \"vue\";\nimport { mapState } from \"vuex\";\nimport listBlock from \"./listBlock.vue\";\nimport listPanel from \"./listPanel.vue\";\nimport { event } from \"@front/util_function/eventBus\";\nexport default defineComponent({\n\tname: \"superChatList\",\n\tcomponents: { listBlock, listPanel },\n\tdata() {\n\t\tconst timeCounter: any = null;\n\t\treturn {\n\t\t\tcurrentTime: 0,\n\t\t\ttimeCounter\n\t\t};\n\t},\n\tmounted() {\n\t\tthis.count();\n\t\tevent.on(\"super-chat-updated\", this.update);\n\t},\n\tbeforeUnmount() {\n\t\tclearTimeout(this.timeCounter);\n\t\tevent.off(\"super-chat-updated\", this.update);\n\t},\n\tcomputed: {\n\t\t...mapState([\"temp\", \"danmakuProfile\"]),\n\t\tsuperChatArray(): Array<any> {\n\t\t\treturn this.temp.superChatArray;\n\t\t},\n\t\tdisplayType(): number {\n\t\t\treturn this.danmakuProfile.common?.superChat?.displayType || 0;\n\t\t}\n\t},\n\tmethods: {\n\t\tupdate() {\n\t\t\tif (this.temp.superChatID) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.next();\n\t\t},\n\t\tcount() {\n\t\t\tclearTimeout(this.timeCounter);\n\t\t\tthis.currentTime = Date.now();\n\t\t\tthis.timeCounter = setTimeout(() => {\n\t\t\t\tthis.count();\n\t\t\t}, 1000);\n\t\t},\n\t\tnext() {\n\t\t\tconst nextOne = this.temp.superChatArray.find(\n\t\t\t\t(block: any) => !block?.showed\n\t\t\t);\n\t\t\tif (\n\t\t\t\t!nextOne &&\n\t\t\t\tthis.currentTime > this.temp.superChatBlock.listEndTime\n\t\t\t) {\n\t\t\t\tthis.temp.superChatID = 0;\n\t\t\t\tthis.temp.superChatBlock = false;\n\t\t\t} else {\n\t\t\t\tthis.select(nextOne);\n\t\t\t}\n\t\t},\n\t\tselect(block: any, time = 20000) {\n\t\t\tblock.showed = true;\n\t\t\tblock.panelEndTime = Date.now() + time;\n\t\t\tif (block.listEndTime < block.panelEndTime) {\n\t\t\t\tblock.listEndTime = block.panelEndTime;\n\t\t\t}\n\t\t\tthis.temp.superChatID = block.uid;\n\t\t\tthis.temp.superChatBlock = block;\n\t\t},\n\t\tremove(block: any) {\n\t\t\tthis.temp.superChatArray = this.temp.superChatArray.filter(\n\t\t\t\t(blockI: any) => blockI !== block\n\t\t\t);\n\t\t\tif (block.uid === this.temp.superChatID) {\n\t\t\t\tthis.next();\n\t\t\t}\n\t\t}\n\t}\n});\n","import { render } from \"./index.vue?vue&type=template&id=3c0b1be0&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=ts\"\nexport * from \"./index.vue?vue&type=script&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=3c0b1be0&scoped=true&lang=scss\"\nscript.render = render\nscript.__scopeId = \"data-v-3c0b1be0\"\n\nexport default script"],"sourceRoot":""}