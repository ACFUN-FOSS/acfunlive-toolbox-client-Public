{"version":3,"sources":["webpack:///./src/electron_browser/components/danmakuFlow/utils/styleGetter.ts","webpack:///./src/electron_browser/components/superChat/index.vue","webpack:///./src/electron_browser/components/superChat/index.vue?9c80","webpack:///./src/electron_browser/components/superChat/index.vue?7ed0","webpack:///./src/electron_browser/components/superChat/index.vue?0ca4","webpack:///./src/electron_browser/views/danmakuWeb/self.vue","webpack:///./src/electron_browser/views/danmakuWeb/self.vue?03b0","webpack:///./src/electron_browser/views/danmakuWeb/self.vue?0865","webpack:///./src/electron_browser/views/danmakuWeb/self.vue?f2b3"],"names":["size","style","output","sizes","forEach","undefined","aspectRatio","padding","result","attrs","attr","margin","border","borderWidth","borderColor","outerBox","overflow","borderRadius","verticalAlign","background","backgroundColor","backgroundSize","backgroundImage","degreeColor","colors","degree","Array","isArray","length","find","i","level","sort","a","b","color","position","zIndex","display","positions","font","fontSize","fontWeight","textShadow","textShadowWidth","textShadowColor","fontStyle","textDecoration","fontName","match","document","querySelector","head","styleEle","createElement","id","type","appendChild","createTextNode","fontFamily","transform","rotateZ","class","temp","superChatArray","scBlock","selectedID","superChatID","select","displayType","ruleIndex","key","uid","sc-block","currentTime","remove","name","mode","superChatBlock","next","components","listBlock","listPanel","timeCounter","this","count","on","update","clearTimeout","off","computed","danmakuProfile","common","superChat","methods","Date","now","setTimeout","nextOne","block","showed","listEndTime","time","panelEndTime","filter","blockI","render","__scopeId","superChatEnable","src","url","superChatList","statusTimer","appID","$store","state","isLogined","registerEvents","statusLooper","updateSettings","unRegisterEvents","file","$route","query","link","window","location","host","userSession","userID","roomProfile","liveID","rank","clubName","fetch","cache","then","res","json","web","setMock","handleResponse","restartDanmaku","e","registered","register","subscribeData","error","console","log","includes","streamStatus","step","dispatch","sendDanmaku","wsEmit","sourceID","states","$message","success","message","clearInterval","setInterval","chechEveryThing","value","mockDanmaku","danmaku","contentWindow","postMessage","JSON","stringify"],"mappings":"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","file":"js/chunk-1e37e7c7.3b455708.js","sourcesContent":["export const size = (style: any): any => {\r\n\tconst output = {};\r\n\tconst sizes = [\"width\", \"height\"];\r\n\tsizes.forEach((size: string) => {\r\n\t\tif (style[size] === undefined) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (style[size] > 0) {\r\n\t\t\t// @ts-ignore\r\n\t\t\toutput[size] = `${style[size]}px`;\r\n\t\t}\r\n\t\tif (style[size] < 0) {\r\n\t\t\t// @ts-ignore\r\n\t\t\toutput[size] = `${-style[size]}%`;\r\n\t\t}\r\n\t});\r\n\treturn output;\r\n};\r\nexport const aspectRatio = (style: any): any => {\r\n\tconst { aspectRatio }: any = style;\r\n\tif (aspectRatio) {\r\n\t\treturn {\r\n\t\t\taspectRatio\r\n\t\t};\r\n\t}\r\n\treturn {};\r\n};\r\nexport const padding = (style: any): any => {\r\n\tconst result: any = {};\r\n\tconst attrs = [\r\n\t\t\"paddingTop\",\r\n\t\t\"paddingRight\",\r\n\t\t\"paddingBottom\",\r\n\t\t\"paddingLeft\"\r\n\t];\r\n\tattrs.forEach((attr: any) => {\r\n\t\tif (style[attr] !== undefined) {\r\n\t\t\tresult[attr] =\r\n\t\t\t\tstyle[attr] > 0 ? `${style[attr]}px` : `${-style[attr]}%`;\r\n\t\t}\r\n\t});\r\n\treturn result;\r\n};\r\nexport const margin = (style: any): any => {\r\n\tconst result: any = {};\r\n\tconst attrs = [\"marginTop\", \"marginRight\", \"marginBottom\", \"marginLeft\"];\r\n\tattrs.forEach((attr: any) => {\r\n\t\tif (style[attr] !== undefined) {\r\n\t\t\tresult[attr] = `${style[attr]}px`;\r\n\t\t}\r\n\t});\r\n\treturn result;\r\n};\r\nexport const border = (style: any): any => {\r\n\treturn {\r\n\t\tborder: `${style.borderWidth}px solid ${style.borderColor}`\r\n\t};\r\n};\r\nexport const outerBox = (style: any): any => {\r\n\tconst result: any = {\r\n\t\toverflow: style.overflow,\r\n\t\tborderRadius: `${style.borderRadius}px`,\r\n\t\tverticalAlign: style.verticalAlign,\r\n\t\tbackground: style.backgroundColor,\r\n\t\tbackgroundSize: \"100% 100%\"\r\n\t};\r\n\tif (style.backgroundImage) {\r\n\t\tresult.background = `url(${style.backgroundImage})`;\r\n\t}\r\n\treturn result;\r\n};\r\nexport const degreeColor = (colors: any, degree: number): any => {\r\n\tif (!Array.isArray(colors) || !colors.length) {\r\n\t\treturn \"\";\r\n\t}\r\n\tif (colors.length === 1 || !colors.find((i: any) => degree >= i.level)) {\r\n\t\treturn colors[0].color;\r\n\t} else {\r\n\t\treturn [...colors]\r\n\t\t\t.sort((a: any, b: any) => {\r\n\t\t\t\treturn b.level - a.level;\r\n\t\t\t})\r\n\t\t\t.find((i: any) => degree >= i.level).color;\r\n\t}\r\n};\r\nexport const position = (style: any): any => {\r\n\tconst output: any = {\r\n\t\tposition: style.position,\r\n\t\tzIndex: style.zIndex,\r\n\t\tdisplay: \"\"\r\n\t};\r\n\tif (output.position === \"relativeBlock\") {\r\n\t\toutput.position = \"relative\";\r\n\t\toutput.display = \"block\";\r\n\t}\r\n\tconst positions = [\"left\", \"top\", \"right\", \"bottom\"];\r\n\tpositions.forEach((position: string) => {\r\n\t\tif (style[position] !== undefined) {\r\n\t\t\toutput[position] =\r\n\t\t\t\tstyle[position] > 0\r\n\t\t\t\t\t? `${style[position]}px`\r\n\t\t\t\t\t: `${-style[position]}%`;\r\n\t\t}\r\n\t});\r\n\treturn output;\r\n};\r\nexport const font = (style: any): any => {\r\n\tconst result: any = {\r\n\t\tfontSize: `${style.fontSize}px`,\r\n\t\tfontWeight: style.fontWeight,\r\n\t\tcolor: style.color,\r\n\t\ttextShadow: `-${style.textShadowWidth}px -${style.textShadowWidth}px 0 ${style.textShadowColor}, 0 -${style.textShadowWidth}px 0 ${style.textShadowColor}, ${style.textShadowWidth}px -${style.textShadowWidth}px 0 ${style.textShadowColor}, ${style.textShadowWidth}px 0 0 ${style.textShadowColor},\r\n\t\t${style.textShadowWidth}px ${style.textShadowWidth}px 0 ${style.textShadowColor}, 0 ${style.textShadowWidth}px 0 ${style.textShadowColor}, -${style.textShadowWidth}px ${style.textShadowWidth}px 0 ${style.textShadowColor}, -${style.textShadowWidth}px 0 0 ${style.textShadowColor}`,\r\n\t\tfontStyle: style.fontStyle,\r\n\t\ttextDecoration: style.textDecoration\r\n\t};\r\n\tif (style.font) {\r\n\t\tlet fontName = style.font.match(/[^/]*(?=.ttf)/g);\r\n\t\tif (fontName) {\r\n\t\t\tfontName = fontName[0];\r\n\t\t\tif (!document.querySelector(`style#${fontName}`)) {\r\n\t\t\t\tconst head = document.head;\r\n\t\t\t\tconst styleEle = document.createElement(\"style\");\r\n\t\t\t\tstyleEle.id = fontName;\r\n\t\t\t\tstyleEle.type = \"text/css\";\r\n\t\t\t\tstyleEle.appendChild(\r\n\t\t\t\t\tdocument.createTextNode(`\r\n\t\t\t\t@font-face { \r\n\t\t\t\t\tfont-family: \"${fontName}\"; \r\n\t\t\t\t\tsrc: url(${style.font}) format('truetype'); \r\n\t\t\t\t} \r\n\t\t\t`)\r\n\t\t\t\t);\r\n\t\t\t\thead.appendChild(styleEle);\r\n\t\t\t}\r\n\t\t\tresult.fontFamily = fontName;\r\n\t\t}\r\n\t}\r\n\treturn result;\r\n};\r\n\r\nexport const transform = (style: any): any => {\r\n\treturn {\r\n\t\ttransform: `rotateZ(${style.rotateZ}deg)`\r\n\t};\r\n};\r\n","<template>\r\n\t<div class=\"super-chat-list\">\r\n\t\t<div class=\"super-chat-list-row\">\r\n\t\t\t<list-block\r\n\t\t\t\t:selectedID=\"temp.superChatID\"\r\n\t\t\t\t@click=\"select(scBlock, 5000)\"\r\n\t\t\t\t:displayType=\"displayType\"\r\n\t\t\t\tv-for=\"scBlock in temp.superChatArray\"\r\n\t\t\t\t:class=\"`list-block-${scBlock.ruleIndex}`\"\r\n\t\t\t\t:key=\"scBlock.uid\"\r\n\t\t\t\t:sc-block=\"scBlock\"\r\n\t\t\t\t:currentTime=\"currentTime\"\r\n\t\t\t\t@end=\"remove(scBlock)\"\r\n\t\t\t/>\r\n\t\t</div>\r\n\t\t<transition name=\"fade\" mode=\"out-in\">\r\n\t\t\t<list-panel\r\n\t\t\t\tclass=\"super-chat-panel\"\r\n\t\t\t\t:class=\"`list-panel-${temp.superChatBlock?.ruleIndex}`\"\r\n\t\t\t\t:displayType=\"displayType\"\r\n\t\t\t\t:key=\"temp.superChatID\"\r\n\t\t\t\tv-if=\"temp.superChatBlock\"\r\n\t\t\t\t:sc-block=\"temp.superChatBlock\"\r\n\t\t\t\t:currentTime=\"currentTime\"\r\n\t\t\t\t@next=\"next()\"\r\n\t\t\t/>\r\n\t\t</transition>\r\n\t</div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { defineComponent } from \"vue\";\r\nimport { mapState } from \"vuex\";\r\nimport listBlock from \"./listBlock.vue\";\r\nimport listPanel from \"./listPanel.vue\";\r\nimport { event } from \"@front/util_function/eventBus\";\r\nexport default defineComponent({\r\n\tname: \"superChatList\",\r\n\tcomponents: { listBlock, listPanel },\r\n\tdata() {\r\n\t\tconst timeCounter: any = null;\r\n\t\treturn {\r\n\t\t\tcurrentTime: 0,\r\n\t\t\ttimeCounter\r\n\t\t};\r\n\t},\r\n\tmounted() {\r\n\t\tthis.count();\r\n\t\tevent.on(\"super-chat-updated\", this.update);\r\n\t},\r\n\tbeforeUnmount() {\r\n\t\tclearTimeout(this.timeCounter);\r\n\t\tevent.off(\"super-chat-updated\", this.update);\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapState([\"temp\", \"danmakuProfile\"]),\r\n\t\tsuperChatArray(): Array<any> {\r\n\t\t\treturn this.temp.superChatArray;\r\n\t\t},\r\n\t\tdisplayType(): number {\r\n\t\t\treturn this.danmakuProfile.common?.superChat?.displayType || 0;\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tupdate() {\r\n\t\t\tif (this.temp.superChatID) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.next();\r\n\t\t},\r\n\t\tcount() {\r\n\t\t\tclearTimeout(this.timeCounter);\r\n\t\t\tthis.currentTime = Date.now();\r\n\t\t\tthis.timeCounter = setTimeout(() => {\r\n\t\t\t\tthis.count();\r\n\t\t\t}, 1000);\r\n\t\t},\r\n\t\tnext() {\r\n\t\t\tconst nextOne = this.temp.superChatArray.find(\r\n\t\t\t\t(block: any) => !block?.showed\r\n\t\t\t);\r\n\t\t\tif (\r\n\t\t\t\t!nextOne &&\r\n\t\t\t\tthis.currentTime > this.temp.superChatBlock.listEndTime\r\n\t\t\t) {\r\n\t\t\t\tthis.temp.superChatID = 0;\r\n\t\t\t\tthis.temp.superChatBlock = false;\r\n\t\t\t} else {\r\n\t\t\t\tthis.select(nextOne);\r\n\t\t\t}\r\n\t\t},\r\n\t\tselect(block: any, time = 20000) {\r\n\t\t\tblock.showed = true;\r\n\t\t\tblock.panelEndTime = Date.now() + time;\r\n\t\t\tif (block.listEndTime < block.panelEndTime) {\r\n\t\t\t\tblock.listEndTime = block.panelEndTime;\r\n\t\t\t}\r\n\t\t\tthis.temp.superChatID = block.uid;\r\n\t\t\tthis.temp.superChatBlock = block;\r\n\t\t},\r\n\t\tremove(block: any) {\r\n\t\t\tthis.temp.superChatArray = this.temp.superChatArray.filter(\r\n\t\t\t\t(blockI: any) => blockI !== block\r\n\t\t\t);\r\n\t\t\tif (block.uid === this.temp.superChatID) {\r\n\t\t\t\tthis.next();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import \"@front/styles/variables.scss\";\r\n.super-chat-list {\r\n\tposition: relative;\r\n\twidth: 100%;\r\n\theight: 35px;\r\n\tbox-sizing: border-box;\r\n\tborder: $--border-base;\r\n\t.super-chat-list-row {\r\n\t\tposition: absolute;\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tflex-wrap: wrap;\r\n\t\toverflow: hidden;\r\n\t\tpadding-left: 8px;\r\n\t}\r\n}\r\n</style>\r\n","\r\nimport { defineComponent } from \"vue\";\r\nimport { mapState } from \"vuex\";\r\nimport listBlock from \"./listBlock.vue\";\r\nimport listPanel from \"./listPanel.vue\";\r\nimport { event } from \"@front/util_function/eventBus\";\r\nexport default defineComponent({\r\n\tname: \"superChatList\",\r\n\tcomponents: { listBlock, listPanel },\r\n\tdata() {\r\n\t\tconst timeCounter: any = null;\r\n\t\treturn {\r\n\t\t\tcurrentTime: 0,\r\n\t\t\ttimeCounter\r\n\t\t};\r\n\t},\r\n\tmounted() {\r\n\t\tthis.count();\r\n\t\tevent.on(\"super-chat-updated\", this.update);\r\n\t},\r\n\tbeforeUnmount() {\r\n\t\tclearTimeout(this.timeCounter);\r\n\t\tevent.off(\"super-chat-updated\", this.update);\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapState([\"temp\", \"danmakuProfile\"]),\r\n\t\tsuperChatArray(): Array<any> {\r\n\t\t\treturn this.temp.superChatArray;\r\n\t\t},\r\n\t\tdisplayType(): number {\r\n\t\t\treturn this.danmakuProfile.common?.superChat?.displayType || 0;\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tupdate() {\r\n\t\t\tif (this.temp.superChatID) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.next();\r\n\t\t},\r\n\t\tcount() {\r\n\t\t\tclearTimeout(this.timeCounter);\r\n\t\t\tthis.currentTime = Date.now();\r\n\t\t\tthis.timeCounter = setTimeout(() => {\r\n\t\t\t\tthis.count();\r\n\t\t\t}, 1000);\r\n\t\t},\r\n\t\tnext() {\r\n\t\t\tconst nextOne = this.temp.superChatArray.find(\r\n\t\t\t\t(block: any) => !block?.showed\r\n\t\t\t);\r\n\t\t\tif (\r\n\t\t\t\t!nextOne &&\r\n\t\t\t\tthis.currentTime > this.temp.superChatBlock.listEndTime\r\n\t\t\t) {\r\n\t\t\t\tthis.temp.superChatID = 0;\r\n\t\t\t\tthis.temp.superChatBlock = false;\r\n\t\t\t} else {\r\n\t\t\t\tthis.select(nextOne);\r\n\t\t\t}\r\n\t\t},\r\n\t\tselect(block: any, time = 20000) {\r\n\t\t\tblock.showed = true;\r\n\t\t\tblock.panelEndTime = Date.now() + time;\r\n\t\t\tif (block.listEndTime < block.panelEndTime) {\r\n\t\t\t\tblock.listEndTime = block.panelEndTime;\r\n\t\t\t}\r\n\t\t\tthis.temp.superChatID = block.uid;\r\n\t\t\tthis.temp.superChatBlock = block;\r\n\t\t},\r\n\t\tremove(block: any) {\r\n\t\t\tthis.temp.superChatArray = this.temp.superChatArray.filter(\r\n\t\t\t\t(blockI: any) => blockI !== block\r\n\t\t\t);\r\n\t\t\tif (block.uid === this.temp.superChatID) {\r\n\t\t\t\tthis.next();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n","import { render } from \"./index.vue?vue&type=template&id=1b98c025&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=ts\"\nexport * from \"./index.vue?vue&type=script&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=1b98c025&scoped=true&lang=scss\"\nscript.render = render\nscript.__scopeId = \"data-v-1b98c025\"\n\nexport default script","export * from \"-!../../../../node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./index.vue?vue&type=style&index=0&id=1b98c025&scoped=true&lang=scss\"","<template>\r\n\t<div style=\"width:100%;height:100%;position:relative\">\r\n\t\t<super-chat-list class=\"super-chat\" v-if=\"superChatEnable\" />\r\n\t\t<iframe :class=\"{superChatEnable}\" class=\"danmaku-self\" :src=\"url\" />\r\n\t</div>\r\n\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { defineComponent } from \"vue\";\r\nimport { wsevent } from \"@front/api\";\r\nimport { mapState, mapGetters } from \"vuex\";\r\nimport { registerRole, isDev } from \"@front/util_function/base\";\r\nimport { getMockByType } from \"@front/views/danmakuSetting/mock/index\";\r\nimport { loginSession } from \"@front/api/user\";\r\nimport superChatList from \"@front/components/superChat/index.vue\";\r\nimport { danmakuGift } from \"@front/store/danmaku/danmaku\";\r\nimport { commonSettings } from \"@front/datas/danmaku\";\r\nexport default defineComponent({\r\n\tname: \"webDanmaku\",\r\n\tcomponents: { superChatList },\r\n\tdata() {\r\n\t\tconst statusTimer: any = null;\r\n\t\treturn {\r\n\t\t\tstatusTimer,\r\n\t\t\tappID: \"danmakuWeb\"\r\n\t\t};\r\n\t},\r\n\tcreated() {\r\n\t\tthis.$store.state.isLogined = true;\r\n\t\tthis.registerEvents();\r\n\t},\r\n\tmounted() {\r\n\t\tthis.statusLooper();\r\n\t\tthis.updateSettings();\r\n\t\tregisterRole(\"网页端\");\r\n\t},\r\n\tbeforeUnmount() {\r\n\t\tthis.unRegisterEvents();\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapGetters([\"superChatEnable\"]),\r\n\t\t...mapState([\r\n\t\t\t\"userSession\",\r\n\t\t\t\"danmakuProfile\",\r\n\t\t\t\"danmakuSession\",\r\n\t\t\t\"roomProfile\",\r\n\t\t\t\"streamStatus\",\r\n\t\t\t\"rank\"\r\n\t\t]),\r\n\t\turl() {\r\n\t\t\tconst file = this.$route.query.file || \"index.html\";\r\n\t\t\tlet link = `http://${window.location.host}/configFiles/selfDanmaku/${file}`;\r\n\t\t\tif (isDev()) link = `http://${window.location.host}/liveChat`;\r\n\t\t\t// @ts-ignore\r\n\t\t\treturn `${link}?liverUID=${this.userSession?.userID}&liveID=${this.roomProfile?.liveID}&clubName=${this.rank.clubName}`;\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tupdateSettings() {\r\n\t\t\tfetch(\"/configFiles/config.json\", {\r\n\t\t\t\tcache: \"no-cache\"\r\n\t\t\t})\r\n\t\t\t\t.then((res: any) => res.json())\r\n\t\t\t\t.then((json: any) => {\r\n\t\t\t\t\tthis.$store.state.danmakuProfile.web = json.web;\r\n\t\t\t\t\tthis.$store.state.danmakuProfile.common =\r\n\t\t\t\t\t\tjson.common || commonSettings();\r\n\t\t\t\t});\r\n\t\t},\r\n\t\tregisterEvents() {\r\n\t\t\twsevent.on(\"sendMockDanmaku\", this.setMock);\r\n\t\t\twsevent.on(\"server-response\", this.handleResponse);\r\n\t\t\twsevent.on(\"restartDanmaku\", this.restartDanmaku);\r\n\t\t},\r\n\t\tunRegisterEvents() {\r\n\t\t\twsevent.off(\"sendMockDanmaku\", this.setMock);\r\n\t\t\twsevent.off(\"server-response\", this.handleResponse);\r\n\t\t\twsevent.off(\"restartDanmaku\", this.restartDanmaku);\r\n\t\t},\r\n\r\n\t\thandleResponse(e: any) {\r\n\t\t\tfor (const key in e) this.$store.state[key] = e[key];\r\n\t\t\tloginSession(e.userSession || {});\r\n\t\t},\r\n\t\tasync chechEveryThing() {\r\n\t\t\ttry {\r\n\t\t\t\tif (!wsevent.registered) {\r\n\t\t\t\t\tawait wsevent.register(this.appID);\r\n\t\t\t\t}\r\n\t\t\t\tthis.subscribeData();\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.log(error);\r\n\t\t\t}\r\n\t\t\tif (\r\n\t\t\t\tthis.roomProfile.liveID &&\r\n\t\t\t\t![\"danmakuing\", \"streaming\"].includes(this.streamStatus.step)\r\n\t\t\t) {\r\n\t\t\t\tthis.streamStatus.step = \"streaming\";\r\n\t\t\t\tthis.$store.dispatch(\"streaming\", this.sendDanmaku);\r\n\t\t\t}\r\n\t\t},\r\n\t\tsubscribeData() {\r\n\t\t\twsevent.wsEmit(\r\n\t\t\t\t\"register-client\",\r\n\t\t\t\t{\r\n\t\t\t\t\tsourceID: this.appID,\r\n\t\t\t\t\tstates: [\"userSession\", \"roomProfile\", \"rank\"]\r\n\t\t\t\t},\r\n\t\t\t\t\"server\"\r\n\t\t\t);\r\n\t\t},\r\n\t\trestartDanmaku() {\r\n\t\t\tthis.$store.dispatch(\"restartDanmaku\");\r\n\t\t\t(this as any).$message.success({\r\n\t\t\t\tmessage: \"重启弹幕中\"\r\n\t\t\t});\r\n\t\t},\r\n\t\tstatusLooper() {\r\n\t\t\tclearInterval(this.statusTimer);\r\n\t\t\tthis.statusTimer = setInterval(() => {\r\n\t\t\t\tthis.chechEveryThing();\r\n\t\t\t}, 5000);\r\n\t\t},\r\n\t\tsetMock(value: any) {\r\n\t\t\tconst mockDanmaku: any = getMockByType(value);\r\n\t\t\tthis.sendDanmaku(mockDanmaku);\r\n\t\t},\r\n\t\tsendDanmaku(danmaku: any) {\r\n\t\t\tif (danmaku.type === 1005) {\r\n\t\t\t\tdanmakuGift(danmaku, this.$store);\r\n\t\t\t}\r\n\t\t\t// @ts-ignore\r\n\t\t\tdocument\r\n\t\t\t\t.querySelector(\".danmaku-self\")\r\n\t\t\t\t// @ts-ignore\r\n\t\t\t\t.contentWindow.postMessage(JSON.stringify(danmaku));\r\n\t\t}\r\n\t}\r\n});\r\n</script>\r\n<style lang='scss'>\r\n@import \"@front/styles/variables.scss\";\r\nhtml,\r\nbody,\r\n#app {\r\n\tbackground-color: transparent;\r\n\tmin-width: 0px;\r\n\tmin-height: 0px;\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\tpadding: 0px;\r\n}\r\n#app {\r\n\tmargin: 0px;\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\ttransition: none;\r\n}\r\n.danmaku-self {\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\tborder: none;\r\n\tpadding-bottom: 16px !important;\r\n}\r\n.superChatEnable {\r\n\theight: calc(100% - 40px);\r\n}\r\n.super-chat {\r\n\tborder: none !important;\r\n\tmargin-bottom: 5px;\r\n}\r\n</style>\r\n","\r\nimport { defineComponent } from \"vue\";\r\nimport { wsevent } from \"@front/api\";\r\nimport { mapState, mapGetters } from \"vuex\";\r\nimport { registerRole, isDev } from \"@front/util_function/base\";\r\nimport { getMockByType } from \"@front/views/danmakuSetting/mock/index\";\r\nimport { loginSession } from \"@front/api/user\";\r\nimport superChatList from \"@front/components/superChat/index.vue\";\r\nimport { danmakuGift } from \"@front/store/danmaku/danmaku\";\r\nimport { commonSettings } from \"@front/datas/danmaku\";\r\nexport default defineComponent({\r\n\tname: \"webDanmaku\",\r\n\tcomponents: { superChatList },\r\n\tdata() {\r\n\t\tconst statusTimer: any = null;\r\n\t\treturn {\r\n\t\t\tstatusTimer,\r\n\t\t\tappID: \"danmakuWeb\"\r\n\t\t};\r\n\t},\r\n\tcreated() {\r\n\t\tthis.$store.state.isLogined = true;\r\n\t\tthis.registerEvents();\r\n\t},\r\n\tmounted() {\r\n\t\tthis.statusLooper();\r\n\t\tthis.updateSettings();\r\n\t\tregisterRole(\"网页端\");\r\n\t},\r\n\tbeforeUnmount() {\r\n\t\tthis.unRegisterEvents();\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapGetters([\"superChatEnable\"]),\r\n\t\t...mapState([\r\n\t\t\t\"userSession\",\r\n\t\t\t\"danmakuProfile\",\r\n\t\t\t\"danmakuSession\",\r\n\t\t\t\"roomProfile\",\r\n\t\t\t\"streamStatus\",\r\n\t\t\t\"rank\"\r\n\t\t]),\r\n\t\turl() {\r\n\t\t\tconst file = this.$route.query.file || \"index.html\";\r\n\t\t\tlet link = `http://${window.location.host}/configFiles/selfDanmaku/${file}`;\r\n\t\t\tif (isDev()) link = `http://${window.location.host}/liveChat`;\r\n\t\t\t// @ts-ignore\r\n\t\t\treturn `${link}?liverUID=${this.userSession?.userID}&liveID=${this.roomProfile?.liveID}&clubName=${this.rank.clubName}`;\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tupdateSettings() {\r\n\t\t\tfetch(\"/configFiles/config.json\", {\r\n\t\t\t\tcache: \"no-cache\"\r\n\t\t\t})\r\n\t\t\t\t.then((res: any) => res.json())\r\n\t\t\t\t.then((json: any) => {\r\n\t\t\t\t\tthis.$store.state.danmakuProfile.web = json.web;\r\n\t\t\t\t\tthis.$store.state.danmakuProfile.common =\r\n\t\t\t\t\t\tjson.common || commonSettings();\r\n\t\t\t\t});\r\n\t\t},\r\n\t\tregisterEvents() {\r\n\t\t\twsevent.on(\"sendMockDanmaku\", this.setMock);\r\n\t\t\twsevent.on(\"server-response\", this.handleResponse);\r\n\t\t\twsevent.on(\"restartDanmaku\", this.restartDanmaku);\r\n\t\t},\r\n\t\tunRegisterEvents() {\r\n\t\t\twsevent.off(\"sendMockDanmaku\", this.setMock);\r\n\t\t\twsevent.off(\"server-response\", this.handleResponse);\r\n\t\t\twsevent.off(\"restartDanmaku\", this.restartDanmaku);\r\n\t\t},\r\n\r\n\t\thandleResponse(e: any) {\r\n\t\t\tfor (const key in e) this.$store.state[key] = e[key];\r\n\t\t\tloginSession(e.userSession || {});\r\n\t\t},\r\n\t\tasync chechEveryThing() {\r\n\t\t\ttry {\r\n\t\t\t\tif (!wsevent.registered) {\r\n\t\t\t\t\tawait wsevent.register(this.appID);\r\n\t\t\t\t}\r\n\t\t\t\tthis.subscribeData();\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.log(error);\r\n\t\t\t}\r\n\t\t\tif (\r\n\t\t\t\tthis.roomProfile.liveID &&\r\n\t\t\t\t![\"danmakuing\", \"streaming\"].includes(this.streamStatus.step)\r\n\t\t\t) {\r\n\t\t\t\tthis.streamStatus.step = \"streaming\";\r\n\t\t\t\tthis.$store.dispatch(\"streaming\", this.sendDanmaku);\r\n\t\t\t}\r\n\t\t},\r\n\t\tsubscribeData() {\r\n\t\t\twsevent.wsEmit(\r\n\t\t\t\t\"register-client\",\r\n\t\t\t\t{\r\n\t\t\t\t\tsourceID: this.appID,\r\n\t\t\t\t\tstates: [\"userSession\", \"roomProfile\", \"rank\"]\r\n\t\t\t\t},\r\n\t\t\t\t\"server\"\r\n\t\t\t);\r\n\t\t},\r\n\t\trestartDanmaku() {\r\n\t\t\tthis.$store.dispatch(\"restartDanmaku\");\r\n\t\t\t(this as any).$message.success({\r\n\t\t\t\tmessage: \"重启弹幕中\"\r\n\t\t\t});\r\n\t\t},\r\n\t\tstatusLooper() {\r\n\t\t\tclearInterval(this.statusTimer);\r\n\t\t\tthis.statusTimer = setInterval(() => {\r\n\t\t\t\tthis.chechEveryThing();\r\n\t\t\t}, 5000);\r\n\t\t},\r\n\t\tsetMock(value: any) {\r\n\t\t\tconst mockDanmaku: any = getMockByType(value);\r\n\t\t\tthis.sendDanmaku(mockDanmaku);\r\n\t\t},\r\n\t\tsendDanmaku(danmaku: any) {\r\n\t\t\tif (danmaku.type === 1005) {\r\n\t\t\t\tdanmakuGift(danmaku, this.$store);\r\n\t\t\t}\r\n\t\t\t// @ts-ignore\r\n\t\t\tdocument\r\n\t\t\t\t.querySelector(\".danmaku-self\")\r\n\t\t\t\t// @ts-ignore\r\n\t\t\t\t.contentWindow.postMessage(JSON.stringify(danmaku));\r\n\t\t}\r\n\t}\r\n});\r\n","import { render } from \"./self.vue?vue&type=template&id=a5e6d564\"\nimport script from \"./self.vue?vue&type=script&lang=ts\"\nexport * from \"./self.vue?vue&type=script&lang=ts\"\n\nimport \"./self.vue?vue&type=style&index=0&id=a5e6d564&lang=scss\"\nscript.render = render\n\nexport default script","export * from \"-!../../../../node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./self.vue?vue&type=style&index=0&id=a5e6d564&lang=scss\""],"sourceRoot":""}