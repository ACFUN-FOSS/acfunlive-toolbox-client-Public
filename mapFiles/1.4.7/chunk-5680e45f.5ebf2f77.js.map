{"version":3,"sources":["webpack:///./src/electron_browser/views/login/index.vue?4d40","webpack:///./src/electron_browser/views/login/index.vue","webpack:///./src/electron_browser/util_function/cookies.ts","webpack:///./src/electron_browser/components/system/topbars/base.vue","webpack:///./src/electron_browser/components/system/topbars/base.vue?04ad","webpack:///./src/electron_browser/components/system/topbars/base.vue?6d73","webpack:///./src/electron_browser/views/login/index.vue?7103","webpack:///./src/electron_browser/views/login/index.vue?0842","webpack:///./src/electron_browser/components/system/topbars/base.vue?67d2"],"names":["id","class","src","name","mode","welcome","loginTexts","welcomeLogo","welcomeLogoKey","welcomeText","userData","account","disabled","logining","login","placeholder","type","password","disclaimerCheck","disclaimerDialog","keepLogined","loginDisabled","key","loginText","custom-class","title","footer","size","disclaimer","common","version","Cookies","value","localStorage","setItem","getItem","minimize","close","HandlerMoving","components","methods","render","__scopeId","topbarBase","loginFailedText","computed","this","$store","state","api","streamStatus","step","getCookie","dispatch","then","autoLogin","res","danmakuProfile","general","streamToolEnable","streamToolPath","sessionStorage","validation","setCookie","String","Math","random","setTimeout","$router","replace","catch","err","console","error","get","JSON","parse","set","stringify"],"mappings":"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","file":"js/chunk-5680e45f.5ebf2f77.js","sourcesContent":["export * from \"-!../../../../node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./index.vue?vue&type=style&index=0&id=2ebee0d7&lang=scss&scoped=true\"","<template>\r\n\t<div id=\"login\">\r\n\t\t<topbar-base class=\"topbar\" />\r\n\t\t<transition name=\"fade\" mode=\"out-in\">\r\n\t\t\t<div class=\"panel\" v-if=\"!welcome\">\r\n\t\t\t\t<hero-base class=\"hero\" />\r\n\t\t\t\t<div class=\"form\">\r\n\t\t\t\t\t<div class=\"row\">\r\n\t\t\t\t\t\t<el-input v-model=\"userData.account\" :disabled=\"logining\" @keypress.enter=\"login\" placeholder=\"A站账号手机号/邮箱\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"row\">\r\n\t\t\t\t\t\t<el-input type=\"password\" v-model=\"userData.password\" :disabled=\"logining\" @keypress.enter=\"login\" placeholder=\"A站密码\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"row sep\">\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<el-checkbox class=\"logCheck\" v-model=\"userData.disclaimerCheck\" :disabled=\"logining\" />\r\n\t\t\t\t\t\t\t同意 ><el-button type=\"text\" class=\"buttonText\" @click=\"disclaimerDialog = true\" :disabled=\"logining\">免责声明\r\n\t\t\t\t\t\t\t</el-button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<el-checkbox class=\"logCheck\" v-model=\"userData.keepLogined\" :disabled=\"logining\" />\r\n\t\t\t\t\t\t\t保持登录\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"row\">\r\n\t\t\t\t\t\t<el-button type=\"primary\" :disabled=\"loginDisabled\" class=\"logBtn\" @click=\"login\">登陆</el-button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"row logText\">\r\n\t\t\t\t\t\t<transition name=\"fade\" mode=\"out-in\">\r\n\t\t\t\t\t\t\t<div :key=\"loginText\">{{ loginText }}</div>\r\n\t\t\t\t\t\t</transition>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<div class=\"welcome\" v-else>\r\n\t\t\t\t<img class=\"welcomeLogo\" :src=\"`${loginTexts.welcomeLogo}?a=${welcomeLogoKey}`\" />\r\n\t\t\t\t<div class=\"welcomeText\">{{ loginTexts.welcomeText }}</div>\r\n\t\t\t</div>\r\n\t\t</transition>\r\n\t\t<footer-base class=\"foter right\" />\r\n\t\t<el-dialog custom-class=\"dialogBase\" title=\"免责声明\" v-model=\"disclaimerDialog\">\r\n\t\t\t<div>{{ loginTexts.disclaimer }}</div>\r\n\t\t\t<template #footer>\r\n\t\t\t\t<el-button type=\"primary\" size=\"mini\" @click=\"\r\n\t\t\t\t\t\tuserData.disclaimerCheck = true;\r\n\t\t\t\t\t\tdisclaimerDialog = false;\r\n\t\t\t\t\t\">我同意</el-button>\r\n\t\t\t</template>\r\n\t\t</el-dialog>\r\n\t\t<img class=\"acgirl\" src=\"/imgs/common/welcome.png\" />\r\n\t\t<div class=\"foter left\">软件版本号：{{common.version}}</div>\r\n\t</div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { defineComponent } from \"vue\";\r\nimport Cookies from \"@front/util_function/cookies\";\r\nimport topbarBase from \"@front/components/system/topbars/base.vue\";\r\nimport {\r\n\tbackendRestart,\r\n\tloadConfig,\r\n\tlaunch\r\n} from \"@front/util_function/system\";\r\nimport { assign } from \"@front/util_function/base\";\r\nimport { isOnline } from \"@front/api/server\";\r\nimport { login as loginTexts, common } from \"@front/texts\";\r\nexport default defineComponent({\r\n\tname: \"login\",\r\n\tcomponents: {\r\n\t\ttopbarBase\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tuserData: {\r\n\t\t\t\taccount: \"\",\r\n\t\t\t\tpassword: \"\",\r\n\t\t\t\tkeepLogined: false,\r\n\t\t\t\tdisclaimerCheck: false\r\n\t\t\t},\r\n\t\t\tcommon: common(),\r\n\t\t\tdisclaimerDialog: false,\r\n\t\t\tlogining: false,\r\n\t\t\tloginFailedText: \"\",\r\n\t\t\twelcome: false,\r\n\t\t\twelcomeLogoKey: \"111\"\r\n\t\t};\r\n\t},\r\n\tcomputed: {\r\n\t\tloginTexts,\r\n\t\tapi(): any {\r\n\t\t\treturn this.$store.state.api;\r\n\t\t},\r\n\t\tloginDisabled(): boolean {\r\n\t\t\treturn (\r\n\t\t\t\t!this.userData.account ||\r\n\t\t\t\t!this.userData.password ||\r\n\t\t\t\t!this.userData.disclaimerCheck ||\r\n\t\t\t\tthis.logining ||\r\n\t\t\t\tthis.$store.state.streamStatus.step === \"offline\"\r\n\t\t\t);\r\n\t\t},\r\n\t\tloginText(): string {\r\n\t\t\tif (this.logining) {\r\n\t\t\t\treturn \"登陆中...\";\r\n\t\t\t}\r\n\t\t\tif (this.loginFailedText) {\r\n\t\t\t\treturn `登陆失败： ${this.loginFailedText}`;\r\n\t\t\t}\r\n\t\t\tif (this.$store.state.streamStatus.step !== \"offline\") {\r\n\t\t\t\treturn \"服务端已连接\";\r\n\t\t\t}\r\n\t\t\treturn \"服务端离线,请尝试关闭工具箱并右键以管理员权限打开\";\r\n\t\t}\r\n\t},\r\n\tmounted() {\r\n\t\tthis.getCookie();\r\n\t\tthis.$store.dispatch(\"startServe\").then(() => {\r\n\t\t\tthis.autoLogin();\r\n\t\t});\r\n\t\tloadConfig().then((res: any) => {\r\n\t\t\tif (res) {\r\n\t\t\t\tassign(this.$store.state.danmakuProfile, res);\r\n\t\t\t}\r\n\t\t\tif (\r\n\t\t\t\tres?.general?.streamToolEnable &&\r\n\t\t\t\tres?.general?.streamToolPath\r\n\t\t\t) {\r\n\t\t\t\tlaunch(res?.general?.streamToolPath);\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\tmethods: {\r\n\t\tautoLogin(): void {\r\n\t\t\tif (\r\n\t\t\t\tthis.getCookie() &&\r\n\t\t\t\tthis.userData.keepLogined &&\r\n\t\t\t\tsessionStorage.getItem(\"firstTime\") !== \"false\"\r\n\t\t\t) {\r\n\t\t\t\tthis.login();\r\n\t\t\t}\r\n\t\t},\r\n\t\tlogin() {\r\n\t\t\tif (!isOnline()) {\r\n\t\t\t\tthis.$store\r\n\t\t\t\t\t.dispatch(\"startServe\")\r\n\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\tthis.login();\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch((error: any) => {\r\n\t\t\t\t\t\tconsole.error(error);\r\n\t\t\t\t\t\tbackendRestart();\r\n\t\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.logining = true;\r\n\t\t\tif (!this.validation()) {\r\n\t\t\t\tthis.logining = false;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.$store\r\n\t\t\t\t.dispatch(\"login\", this.userData)\r\n\t\t\t\t.then(() => {\r\n\t\t\t\t\tthis.$store.state.userData = this.userData;\r\n\t\t\t\t\tsessionStorage.setItem(\"logined\", \"true\");\r\n\t\t\t\t\tsessionStorage.setItem(\"firstTime\", \"false\");\r\n\t\t\t\t\tif (this.userData.keepLogined) {\r\n\t\t\t\t\t\tthis.setCookie();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.welcomeLogoKey = String(Math.random());\r\n\t\t\t\t\tthis.welcome = true;\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tthis.$router.replace(\"dashboard\");\r\n\t\t\t\t\t\tthis.welcome = false;\r\n\t\t\t\t\t\tthis.logining = false;\r\n\t\t\t\t\t}, 4000);\r\n\t\t\t\t})\r\n\t\t\t\t.catch((err: any) => {\r\n\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t\tthis.logining = false;\r\n\t\t\t\t\tthis.welcome = false;\r\n\t\t\t\t\tthis.loginFailedText = err;\r\n\t\t\t\t\t// backendRestart();\r\n\t\t\t\t});\r\n\t\t},\r\n\t\tgetCookie() {\r\n\t\t\tconst userData = Cookies.get(\"userData\");\r\n\t\t\tif (!userData) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tthis.userData = JSON.parse(userData);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tsetCookie() {\r\n\t\t\tCookies.set(\"userData\", JSON.stringify(this.userData));\r\n\t\t},\r\n\t\tvalidation() {\r\n\t\t\tif (\r\n\t\t\t\t!this.userData.account ||\r\n\t\t\t\t!this.userData.password ||\r\n\t\t\t\t!this.userData.disclaimerCheck\r\n\t\t\t) {\r\n\t\t\t\treturn false;\r\n\t\t\t} else {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n@import \"@front/styles/variables.scss\";\r\n#login {\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\tfont-size: $--font-size-base;\r\n\tcolor: rgba($color: white, $alpha: 0.9);\r\n\tbackground-color: $--color-primary;\r\n\tbox-shadow: $--box-shadow-dark;\r\n\tborder-radius: $--border-radius-small;\r\n\t.topbar {\r\n\t\tposition: absolute;\r\n\t\ttop: 0px;\r\n\t}\r\n\t.welcome {\r\n\t\tposition: absolute;\r\n\t\ttop: 50%;\r\n\t\tleft: 50%;\r\n\t\ttransform: translateX(-50%) translateY(-50%);\r\n\t\tuser-select: none;\r\n\t\ttext-align: center;\r\n\t\t.welcomeLogo {\r\n\t\t\twidth: 200px;\r\n\t\t\tmargin-top: -200px;\r\n\t\t\tpointer-events: none;\r\n\t\t}\r\n\t\t.welcomeText {\r\n\t\t\ttext-align: center;\r\n\t\t\tpadding: 24px 0px;\r\n\t\t\tfont-size: $--font-size-extra-large;\r\n\t\t}\r\n\t}\r\n\t.panel {\r\n\t\tposition: absolute;\r\n\t\ttop: 215px;\r\n\t\tleft: 120px;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: flex-start;\r\n\t\tz-index: 100;\r\n\t\t.hero {\r\n\t\t\tposition: fixed;\r\n\t\t\tleft: 425px;\r\n\t\t\ttop: 121px;\r\n\t\t\twidth: calc(100vw - 645px);\r\n\t\t}\r\n\t\t.form {\r\n\t\t\tpadding: 24px 0px;\r\n\t\t\theight: 300px;\r\n\t\t\twidth: 300px;\r\n\t\t\t.row {\r\n\t\t\t\tpadding: 6px 0px;\r\n\t\t\t\t.logBtn {\r\n\t\t\t\t\twidth: 300px;\r\n\t\t\t\t\theight: 42px;\r\n\t\t\t\t\tbackground-color: $--color-primary-light-3;\r\n\t\t\t\t\t&:hover {\r\n\t\t\t\t\t\tbackground-color: $--color-primary-light-5;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t&.sep {\r\n\t\t\t\t\tdisplay: flex !important;\r\n\t\t\t\t\tjustify-content: space-between;\r\n\t\t\t\t\talign-items: center;\r\n\t\t\t\t\tuser-select: none;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t&.logText {\r\n\t\t\t\tpadding: 16px 0px;\r\n\t\t\t\tuser-select: none;\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\tword-break: break-all;\r\n\t\t\t}\r\n\r\n\t\t\t.buttonText {\r\n\t\t\t\tcolor: $--color-primary-light-3 !important;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n.foter {\r\n\tposition: absolute;\r\n\tbottom: 0px;\r\n\tfont-size: $--font-size-extra-small;\r\n\tcolor: rgba($color: white, $alpha: 0.5);\r\n\tpadding: 16px 0px;\r\n\t&.left {\r\n\t\tleft: 10px;\r\n\t\ttext-align: left;\r\n\t}\r\n\t&.right {\r\n\t\tright: 10px;\r\n\t\ttext-align: right;\r\n\t}\r\n}\r\n.acgirl {\r\n\tposition: absolute;\r\n\tright: 0px;\r\n\tbottom: 60px;\r\n}\r\n</style>\r\n","export default class Cookies {\r\n\tstatic set(key: string, value: string): void {\r\n\t\tlocalStorage.setItem(key, value);\r\n\t}\r\n\r\n\tstatic get(key: string): string | null {\r\n\t\treturn localStorage.getItem(key);\r\n\t}\r\n}\r\n","<template>\r\n\t<div id=\"topbar\">\r\n\t\t<div class=\"handler\">\r\n\t\t\t<handler-moving>\r\n\t\t\t\t<span class=\"el-icon-more-outline\" />\r\n\t\t\t</handler-moving>\r\n\t\t</div>\r\n\t\t<div class=\"button el-icon-minus\" @click=\"minimize()\" />\r\n\t\t<div class=\"button el-icon-close\" @click=\"close()\" />\r\n\t</div>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { defineComponent, defineAsyncComponent } from \"vue\";\r\nimport { minimize, close } from \"@front/util_function/system\";\r\nconst HandlerMoving = defineAsyncComponent(() =>\r\n\timport(\"@front/components/system/HandlerMoving.vue\")\r\n);\r\nexport default defineComponent({\r\n\tname: \"topbarBase\",\r\n\tcomponents: {\r\n\t\tHandlerMoving\r\n\t},\r\n\tmethods: {\r\n\t\tminimize,\r\n\t\tclose\r\n\t}\r\n});\r\n</script>\r\n\r\n<style scoped lang='scss'>\r\n#topbar {\r\n\twidth: 100%;\r\n\theight: 24px;\r\n\tdisplay: flex;\r\n\tposition: relative;\r\n\ttransition: background-color 0.25s;\r\n\tcursor: move;\r\n\t&:hover {\r\n\t\tbackground: rgba(0, 0, 0, 0.05);\r\n\t}\r\n\t.handler {\r\n\t\tposition: relative;\r\n\t\tflex-grow: 1;\r\n\t\tcolor: white;\r\n\t}\r\n\t.button {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tcursor: pointer;\r\n\t\tborder: none;\r\n\t\tbackground-color: rgba(0, 0, 0, 0);\r\n\t\tfont-size: 14px;\r\n\t\tcolor: white;\r\n\t\tborder-radius: 0px;\r\n\t\tpadding: 2px 8px;\r\n\t\tmargin: 0px;\r\n\t\ttransition: background-color 0.25s;\r\n\t\t&:hover {\r\n\t\t\tbackground-color: rgba(0, 0, 0, 0.25);\r\n\t\t}\r\n\t}\r\n}\r\n</style>\r\n","\r\nimport { defineComponent, defineAsyncComponent } from \"vue\";\r\nimport { minimize, close } from \"@front/util_function/system\";\r\nconst HandlerMoving = defineAsyncComponent(() =>\r\n\timport(\"@front/components/system/HandlerMoving.vue\")\r\n);\r\nexport default defineComponent({\r\n\tname: \"topbarBase\",\r\n\tcomponents: {\r\n\t\tHandlerMoving\r\n\t},\r\n\tmethods: {\r\n\t\tminimize,\r\n\t\tclose\r\n\t}\r\n});\r\n","import { render } from \"./base.vue?vue&type=template&id=5f1e490e&scoped=true\"\nimport script from \"./base.vue?vue&type=script&lang=ts\"\nexport * from \"./base.vue?vue&type=script&lang=ts\"\n\nimport \"./base.vue?vue&type=style&index=0&id=5f1e490e&scoped=true&lang=scss\"\nscript.render = render\nscript.__scopeId = \"data-v-5f1e490e\"\n\nexport default script","\r\nimport { defineComponent } from \"vue\";\r\nimport Cookies from \"@front/util_function/cookies\";\r\nimport topbarBase from \"@front/components/system/topbars/base.vue\";\r\nimport {\r\n\tbackendRestart,\r\n\tloadConfig,\r\n\tlaunch\r\n} from \"@front/util_function/system\";\r\nimport { assign } from \"@front/util_function/base\";\r\nimport { isOnline } from \"@front/api/server\";\r\nimport { login as loginTexts, common } from \"@front/texts\";\r\nexport default defineComponent({\r\n\tname: \"login\",\r\n\tcomponents: {\r\n\t\ttopbarBase\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tuserData: {\r\n\t\t\t\taccount: \"\",\r\n\t\t\t\tpassword: \"\",\r\n\t\t\t\tkeepLogined: false,\r\n\t\t\t\tdisclaimerCheck: false\r\n\t\t\t},\r\n\t\t\tcommon: common(),\r\n\t\t\tdisclaimerDialog: false,\r\n\t\t\tlogining: false,\r\n\t\t\tloginFailedText: \"\",\r\n\t\t\twelcome: false,\r\n\t\t\twelcomeLogoKey: \"111\"\r\n\t\t};\r\n\t},\r\n\tcomputed: {\r\n\t\tloginTexts,\r\n\t\tapi(): any {\r\n\t\t\treturn this.$store.state.api;\r\n\t\t},\r\n\t\tloginDisabled(): boolean {\r\n\t\t\treturn (\r\n\t\t\t\t!this.userData.account ||\r\n\t\t\t\t!this.userData.password ||\r\n\t\t\t\t!this.userData.disclaimerCheck ||\r\n\t\t\t\tthis.logining ||\r\n\t\t\t\tthis.$store.state.streamStatus.step === \"offline\"\r\n\t\t\t);\r\n\t\t},\r\n\t\tloginText(): string {\r\n\t\t\tif (this.logining) {\r\n\t\t\t\treturn \"登陆中...\";\r\n\t\t\t}\r\n\t\t\tif (this.loginFailedText) {\r\n\t\t\t\treturn `登陆失败： ${this.loginFailedText}`;\r\n\t\t\t}\r\n\t\t\tif (this.$store.state.streamStatus.step !== \"offline\") {\r\n\t\t\t\treturn \"服务端已连接\";\r\n\t\t\t}\r\n\t\t\treturn \"服务端离线,请尝试关闭工具箱并右键以管理员权限打开\";\r\n\t\t}\r\n\t},\r\n\tmounted() {\r\n\t\tthis.getCookie();\r\n\t\tthis.$store.dispatch(\"startServe\").then(() => {\r\n\t\t\tthis.autoLogin();\r\n\t\t});\r\n\t\tloadConfig().then((res: any) => {\r\n\t\t\tif (res) {\r\n\t\t\t\tassign(this.$store.state.danmakuProfile, res);\r\n\t\t\t}\r\n\t\t\tif (\r\n\t\t\t\tres?.general?.streamToolEnable &&\r\n\t\t\t\tres?.general?.streamToolPath\r\n\t\t\t) {\r\n\t\t\t\tlaunch(res?.general?.streamToolPath);\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\tmethods: {\r\n\t\tautoLogin(): void {\r\n\t\t\tif (\r\n\t\t\t\tthis.getCookie() &&\r\n\t\t\t\tthis.userData.keepLogined &&\r\n\t\t\t\tsessionStorage.getItem(\"firstTime\") !== \"false\"\r\n\t\t\t) {\r\n\t\t\t\tthis.login();\r\n\t\t\t}\r\n\t\t},\r\n\t\tlogin() {\r\n\t\t\tif (!isOnline()) {\r\n\t\t\t\tthis.$store\r\n\t\t\t\t\t.dispatch(\"startServe\")\r\n\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\tthis.login();\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch((error: any) => {\r\n\t\t\t\t\t\tconsole.error(error);\r\n\t\t\t\t\t\tbackendRestart();\r\n\t\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.logining = true;\r\n\t\t\tif (!this.validation()) {\r\n\t\t\t\tthis.logining = false;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.$store\r\n\t\t\t\t.dispatch(\"login\", this.userData)\r\n\t\t\t\t.then(() => {\r\n\t\t\t\t\tthis.$store.state.userData = this.userData;\r\n\t\t\t\t\tsessionStorage.setItem(\"logined\", \"true\");\r\n\t\t\t\t\tsessionStorage.setItem(\"firstTime\", \"false\");\r\n\t\t\t\t\tif (this.userData.keepLogined) {\r\n\t\t\t\t\t\tthis.setCookie();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.welcomeLogoKey = String(Math.random());\r\n\t\t\t\t\tthis.welcome = true;\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tthis.$router.replace(\"dashboard\");\r\n\t\t\t\t\t\tthis.welcome = false;\r\n\t\t\t\t\t\tthis.logining = false;\r\n\t\t\t\t\t}, 4000);\r\n\t\t\t\t})\r\n\t\t\t\t.catch((err: any) => {\r\n\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t\tthis.logining = false;\r\n\t\t\t\t\tthis.welcome = false;\r\n\t\t\t\t\tthis.loginFailedText = err;\r\n\t\t\t\t\t// backendRestart();\r\n\t\t\t\t});\r\n\t\t},\r\n\t\tgetCookie() {\r\n\t\t\tconst userData = Cookies.get(\"userData\");\r\n\t\t\tif (!userData) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tthis.userData = JSON.parse(userData);\r\n\t\t\treturn true;\r\n\t\t},\r\n\t\tsetCookie() {\r\n\t\t\tCookies.set(\"userData\", JSON.stringify(this.userData));\r\n\t\t},\r\n\t\tvalidation() {\r\n\t\t\tif (\r\n\t\t\t\t!this.userData.account ||\r\n\t\t\t\t!this.userData.password ||\r\n\t\t\t\t!this.userData.disclaimerCheck\r\n\t\t\t) {\r\n\t\t\t\treturn false;\r\n\t\t\t} else {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n","import { render } from \"./index.vue?vue&type=template&id=2ebee0d7&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=ts\"\nexport * from \"./index.vue?vue&type=script&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=2ebee0d7&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-2ebee0d7\"\n\nexport default script","export * from \"-!../../../../../node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./base.vue?vue&type=style&index=0&id=5f1e490e&scoped=true&lang=scss\""],"sourceRoot":""}