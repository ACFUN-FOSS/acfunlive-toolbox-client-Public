{"version":3,"sources":["webpack:///./src/electron_browser/util_function/formatter.ts","webpack:///./src/electron_browser/views/general/index.vue?d709","webpack:///./src/electron_browser/views/general/index.vue","webpack:///./src/electron_browser/util_function/object.ts","webpack:///./src/electron_browser/views/general/index.vue?b9e1","webpack:///./src/electron_browser/views/general/index.vue?a885","webpack:///./node_modules/lodash/uniq.js"],"names":["unixTimeFormatter","timestamp","zeroPadding","n","length","hour","Math","floor","minute","second","String","thousandFormatter","count","unit","toFixed","hundrenFormatter","byteFormatter","byte","shift","class","id","align","style","title","flex","openDocuments","type","size","span","openConsole","general","streamToolEnable","save","model-value","streamToolPath","append","loadStreamToolPath","openFolder","backup","restore","clean","disabled","cacheSizeUnit","clearStorage","walk","obj","fn","Object","values","output","forEach","item","push","name","cacheSize","this","loadConfig","getCacheSize","computed","methods","join","process","resourcesPath","danmakuProfile","then","res","path","assign","duration","message","offset","localStorage","clear","file","config","$store","state","profile","commit","url","window","open","catch","err","console","error","parseInt","keepList","value","extname","render","__scopeId","baseUniq","uniq","array","module","exports"],"mappings":"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","file":"js/chunk-af40f598.ab672edd.js","sourcesContent":["export const unixTimeFormatter = (timestamp: number) => {\r\n\tconst zeroPadding = (n: string) => {\r\n\t\tif (n.length < 2) {\r\n\t\t\treturn `0${n}`;\r\n\t\t}\r\n\t\treturn n;\r\n\t};\r\n\ttimestamp = timestamp / 1000;\r\n\tconst hour = Math.floor(timestamp / 3600);\r\n\tconst minute = Math.floor((timestamp - hour * 3600) / 60);\r\n\tconst second = Math.floor(timestamp % 60);\r\n\treturn `${zeroPadding(String(hour))}:${zeroPadding(\r\n\t\tString(minute)\r\n\t)}:${zeroPadding(String(second))}`;\r\n};\r\nexport const thousandFormatter = (count: number, unit = \"万\"): string => {\r\n\tif (count < 10000) {\r\n\t\treturn String(count);\r\n\t}\r\n\r\n\treturn `${(count / 10000).toFixed(1)}${unit}`;\r\n};\r\n\r\nexport const hundrenFormatter = (count: number): string => {\r\n\tif (count > 10000) {\r\n\t\treturn thousandFormatter(count, \"W\");\r\n\t}\r\n\tif (count > 1000) {\r\n\t\treturn `${(count / 1000).toFixed(1)}k`;\r\n\t}\r\n\treturn String(count);\r\n};\r\n\r\nexport const byteFormatter = (byte: number): string => {\r\n\tconst unit = [\"Byte\", \"KB\", \"MB\", \"GB\", \"T\"];\r\n\twhile (byte > 1024 && unit.length > 1) {\r\n\t\tbyte /= 1024;\r\n\t\tunit.shift();\r\n\t}\r\n\treturn `${byte.toFixed(2)} ${unit[0]}`;\r\n};\r\n","export * from \"-!../../../../node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./index.vue?vue&type=style&index=0&id=05ab9488&scoped=true&lang=scss\"","<template>\r\n\t<content-frame id=\"general\" align=\"row\">\r\n\t\t<row-frame style=\"width:100%\" title=\"使用说明\" flex>\r\n\t\t\t<el-button @click=\"openDocuments\" type=\"primary\" size=\"mini\">点击打开</el-button>\r\n\t\t</row-frame>\r\n\t\t<row-frame style=\"width:100%\" title=\"系统\" flex>\r\n\t\t\t<row-span :span=\"2\">\r\n\t\t\t\t<el-button size=\"mini\" type=\"primary\" @click=\"openConsole\">打开控制台</el-button>\r\n\t\t\t</row-span>\r\n\t\t</row-frame>\r\n\t\t<row-frame style=\"width:100%\" title=\"推流工具路径\" flex>\r\n\t\t\t<row-span :span=\"4\">\r\n\t\t\t\t同步启动推流工具\r\n\t\t\t</row-span>\r\n\t\t\t<row-span :span=\"2\">\r\n\t\t\t\t<el-switch v-model=\"general.streamToolEnable\" @change=\"save\" />\r\n\t\t\t</row-span>\r\n\t\t\t<row-span :span=\"6\" v-if=\"general.streamToolEnable\">\r\n\t\t\t\t<el-input size=\"mini\" :model-value=\"general.streamToolPath\">\r\n\t\t\t\t\t<template #append>\r\n\t\t\t\t\t\t<el-button type=\"primary\" size=\"mini\" class=\"attach\" @click=\"loadStreamToolPath\">点击选择\r\n\t\t\t\t\t\t</el-button>\r\n\t\t\t\t\t</template>\r\n\t\t\t\t</el-input>\r\n\r\n\t\t\t</row-span>\r\n\t\t\t<row-span :span=\"12\"><span class=\"hint\">设置后工具箱启动时会同步打开推流工具(OBS或是直播助手</span></row-span>\r\n\t\t</row-frame>\r\n\t\t<row-frame style=\"width:100%\" title=\"配置文件\" flex>\r\n\t\t\t<row-span :span=\"2\">\r\n\t\t\t\t<el-button size=\"mini\" type=\"primary\" @click=\"openFolder\">打开文件夹</el-button>\r\n\t\t\t</row-span>\r\n\t\t\t<row-span :span=\"2\">\r\n\t\t\t\t<el-button size=\"mini\" type=\"primary\" @click=\"backup\">配置备份</el-button>\r\n\t\t\t</row-span>\r\n\t\t\t<row-span :span=\"2\">\r\n\t\t\t\t<el-button size=\"mini\" type=\"primary\" @click=\"restore\">配置还原</el-button>\r\n\t\t\t</row-span>\r\n\t\t\t<row-span :span=\"12\"><span class=\"hint\">一般情况下不需要备份配置，除非重装系统</span></row-span>\r\n\r\n\t\t</row-frame>\r\n\r\n\t\t<row-frame style=\"width:100%\" title=\"\" flex>\r\n\t\t\t<row-span :span=\"2\">\r\n\t\t\t\t<el-button size=\"mini\" type=\"primary\" @click=\"clean\" disabled>清理配置缓存</el-button>\r\n\t\t\t</row-span>\r\n\t\t\t<row-span :span=\"4\">\r\n\t\t\t\t<span>当前配置缓存:{{cacheSizeUnit}}</span>\r\n\t\t\t</row-span>\r\n\t\t\t<row-span :span=\"12\"><span class=\"hint\">点击清理配置文件夹中不用的图片与文件</span></row-span>\r\n\t\t</row-frame>\r\n\t\t<row-frame style=\"width:100%\" title=\"\" flex>\r\n\t\t\t<row-span :span=\"2\">\r\n\t\t\t\t<el-button size=\"mini\" type=\"primary\" @click=\"clearStorage\">清理账号缓存</el-button>\r\n\t\t\t</row-span>\r\n\t\t\t<row-span :span=\"12\"><span class=\"hint\">房间管理里的设置无法保存或出现混乱时试试清理账号缓存</span></row-span>\r\n\t\t</row-frame>\r\n\t</content-frame>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport { defineComponent } from \"vue\";\r\nimport { generalSettings } from \"@front/datas/danmaku\";\r\nimport { mapState } from \"vuex\";\r\nimport { load } from \"@front/util_function/file\";\r\nimport {\r\n\tsaveConfig,\r\n\trestoreConfig,\r\n\tbackupConfig,\r\n\tgetCacheSize,\r\n\tremoveCache,\r\n\topenCache,\r\n\topenFolder,\r\n\topenConsole\r\n} from \"@front/util_function/system\";\r\nimport cloneDeep from \"lodash/cloneDeep\";\r\nimport { ElMessage } from \"element-plus\";\r\nimport { danmaku } from \"@front/datas\";\r\nimport { assign } from \"@front/util_function/base\";\r\nimport { byteFormatter } from \"@front/util_function/formatter\";\r\nimport { walk } from \"@front/util_function/object\";\r\nimport path from \"path\";\r\nimport uniq from \"lodash/uniq\";\r\nexport default defineComponent({\r\n\tname: \"general\",\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tgeneral: {\r\n\t\t\t\tstreamToolEnable: false,\r\n\t\t\t\tstreamToolPath: \"\"\r\n\t\t\t},\r\n\r\n\t\t\tcacheSize: 0\r\n\t\t};\r\n\t},\r\n\tmounted() {\r\n\t\tthis.loadConfig();\r\n\t\tthis.getCacheSize();\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapState([\"danmakuProfile\"]),\r\n\t\tcacheSizeUnit() {\r\n\t\t\tconst cacheSize: any = this.cacheSize;\r\n\t\t\treturn byteFormatter(cacheSize);\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\topenConsole,\r\n\t\topenDocuments() {\r\n\t\t\topenFolder(path.join(process.resourcesPath, \"../使用说明\"));\r\n\t\t},\r\n\t\tloadConfig() {\r\n\t\t\tthis.general =\r\n\t\t\t\tcloneDeep(this.danmakuProfile.general) || generalSettings();\r\n\t\t},\r\n\t\tloadStreamToolPath() {\r\n\t\t\tload(\".exe\").then((res: any) => {\r\n\t\t\t\tthis.general.streamToolPath = res.path;\r\n\t\t\t\tthis.save();\r\n\t\t\t});\r\n\t\t},\r\n\t\tsave() {\r\n\t\t\tObject.assign(this.danmakuProfile, {\r\n\t\t\t\tgeneral: cloneDeep(this.general)\r\n\t\t\t});\r\n\t\t\tsaveConfig(this.danmakuProfile);\r\n\t\t\tElMessage({\r\n\t\t\t\tduration: 1500,\r\n\t\t\t\tmessage: \"保存成功\",\r\n\t\t\t\toffset: 60,\r\n\t\t\t\ttype: \"success\"\r\n\t\t\t});\r\n\t\t},\r\n\t\tclearStorage() {\r\n\t\t\tlocalStorage.clear();\r\n\t\t\tElMessage({\r\n\t\t\t\ttype: \"success\",\r\n\t\t\t\tmessage: \"清理缓存成功！\",\r\n\t\t\t\tduration: 1500,\r\n\t\t\t\toffset: 60\r\n\t\t\t});\r\n\t\t},\r\n\t\tasync restore() {\r\n\t\t\tconst file: any = await load(\".zip\");\r\n\t\t\tconst config = await restoreConfig(file.path);\r\n\t\t\tif (config) {\r\n\t\t\t\tthis.$store.state.danmakuProfile = assign(\r\n\t\t\t\t\tdanmaku.profile(),\r\n\t\t\t\t\tconfig\r\n\t\t\t\t);\r\n\t\t\t\tthis.loadConfig();\r\n\t\t\t\tthis.$store.commit(\"updateSettings\", {});\r\n\t\t\t\tElMessage({\r\n\t\t\t\t\ttype: \"success\",\r\n\t\t\t\t\tmessage: \"配置还原成功！\",\r\n\t\t\t\t\tduration: 1500,\r\n\t\t\t\t\toffset: 60\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tElMessage({\r\n\t\t\t\t\ttype: \"error\",\r\n\t\t\t\t\tmessage: \"配置还原失败\",\r\n\t\t\t\t\tduration: 1500,\r\n\t\t\t\t\toffset: 60\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\tbackup() {\r\n\t\t\tbackupConfig()\r\n\t\t\t\t.then((url: any) => {\r\n\t\t\t\t\twindow.open(url);\r\n\t\t\t\t})\r\n\t\t\t\t.catch(err => {\r\n\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t});\r\n\t\t},\r\n\t\tgetCacheSize() {\r\n\t\t\tgetCacheSize().then((res: any) => {\r\n\t\t\t\tthis.cacheSize = parseInt(res);\r\n\t\t\t});\r\n\t\t},\r\n\t\tclean() {\r\n\t\t\tconst keepList = walk(\r\n\t\t\t\tthis.$store.state.danmakuProfile,\r\n\t\t\t\t(value: any) => {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\treturn path.extname(value);\r\n\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t\tremoveCache(uniq(keepList)).then(res => {\r\n\t\t\t\tthis.getCacheSize();\r\n\t\t\t});\r\n\t\t},\r\n\t\topenFolder() {\r\n\t\t\topenCache();\r\n\t\t}\r\n\t}\r\n});\r\n</script>\r\n\r\n<style scoped lang='scss'>\r\n@import \"@front/styles/variables.scss\";\r\n#general {\r\n\tposition: absolute;\r\n\twidth: 100%;\r\n\theight: 100%;\r\n}\r\n</style>\r\n","export const walk = (obj: any, fn: any = () => true): Array<any> => {\r\n\tif (typeof obj === \"object\") {\r\n\t\tobj = Object.values(obj);\r\n\t} else {\r\n\t\tif (fn(obj)) {\r\n\t\t\treturn [obj];\r\n\t\t}\r\n\t\treturn [];\r\n\t}\r\n\tconst output: any = [];\r\n\tobj.forEach((item: any) => {\r\n\t\toutput.push(...walk(item, fn));\r\n\t});\r\n\treturn output;\r\n};\r\n","\r\nimport { defineComponent } from \"vue\";\r\nimport { generalSettings } from \"@front/datas/danmaku\";\r\nimport { mapState } from \"vuex\";\r\nimport { load } from \"@front/util_function/file\";\r\nimport {\r\n\tsaveConfig,\r\n\trestoreConfig,\r\n\tbackupConfig,\r\n\tgetCacheSize,\r\n\tremoveCache,\r\n\topenCache,\r\n\topenFolder,\r\n\topenConsole\r\n} from \"@front/util_function/system\";\r\nimport cloneDeep from \"lodash/cloneDeep\";\r\nimport { ElMessage } from \"element-plus\";\r\nimport { danmaku } from \"@front/datas\";\r\nimport { assign } from \"@front/util_function/base\";\r\nimport { byteFormatter } from \"@front/util_function/formatter\";\r\nimport { walk } from \"@front/util_function/object\";\r\nimport path from \"path\";\r\nimport uniq from \"lodash/uniq\";\r\nexport default defineComponent({\r\n\tname: \"general\",\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tgeneral: {\r\n\t\t\t\tstreamToolEnable: false,\r\n\t\t\t\tstreamToolPath: \"\"\r\n\t\t\t},\r\n\r\n\t\t\tcacheSize: 0\r\n\t\t};\r\n\t},\r\n\tmounted() {\r\n\t\tthis.loadConfig();\r\n\t\tthis.getCacheSize();\r\n\t},\r\n\tcomputed: {\r\n\t\t...mapState([\"danmakuProfile\"]),\r\n\t\tcacheSizeUnit() {\r\n\t\t\tconst cacheSize: any = this.cacheSize;\r\n\t\t\treturn byteFormatter(cacheSize);\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\topenConsole,\r\n\t\topenDocuments() {\r\n\t\t\topenFolder(path.join(process.resourcesPath, \"../使用说明\"));\r\n\t\t},\r\n\t\tloadConfig() {\r\n\t\t\tthis.general =\r\n\t\t\t\tcloneDeep(this.danmakuProfile.general) || generalSettings();\r\n\t\t},\r\n\t\tloadStreamToolPath() {\r\n\t\t\tload(\".exe\").then((res: any) => {\r\n\t\t\t\tthis.general.streamToolPath = res.path;\r\n\t\t\t\tthis.save();\r\n\t\t\t});\r\n\t\t},\r\n\t\tsave() {\r\n\t\t\tObject.assign(this.danmakuProfile, {\r\n\t\t\t\tgeneral: cloneDeep(this.general)\r\n\t\t\t});\r\n\t\t\tsaveConfig(this.danmakuProfile);\r\n\t\t\tElMessage({\r\n\t\t\t\tduration: 1500,\r\n\t\t\t\tmessage: \"保存成功\",\r\n\t\t\t\toffset: 60,\r\n\t\t\t\ttype: \"success\"\r\n\t\t\t});\r\n\t\t},\r\n\t\tclearStorage() {\r\n\t\t\tlocalStorage.clear();\r\n\t\t\tElMessage({\r\n\t\t\t\ttype: \"success\",\r\n\t\t\t\tmessage: \"清理缓存成功！\",\r\n\t\t\t\tduration: 1500,\r\n\t\t\t\toffset: 60\r\n\t\t\t});\r\n\t\t},\r\n\t\tasync restore() {\r\n\t\t\tconst file: any = await load(\".zip\");\r\n\t\t\tconst config = await restoreConfig(file.path);\r\n\t\t\tif (config) {\r\n\t\t\t\tthis.$store.state.danmakuProfile = assign(\r\n\t\t\t\t\tdanmaku.profile(),\r\n\t\t\t\t\tconfig\r\n\t\t\t\t);\r\n\t\t\t\tthis.loadConfig();\r\n\t\t\t\tthis.$store.commit(\"updateSettings\", {});\r\n\t\t\t\tElMessage({\r\n\t\t\t\t\ttype: \"success\",\r\n\t\t\t\t\tmessage: \"配置还原成功！\",\r\n\t\t\t\t\tduration: 1500,\r\n\t\t\t\t\toffset: 60\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tElMessage({\r\n\t\t\t\t\ttype: \"error\",\r\n\t\t\t\t\tmessage: \"配置还原失败\",\r\n\t\t\t\t\tduration: 1500,\r\n\t\t\t\t\toffset: 60\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t},\r\n\t\tbackup() {\r\n\t\t\tbackupConfig()\r\n\t\t\t\t.then((url: any) => {\r\n\t\t\t\t\twindow.open(url);\r\n\t\t\t\t})\r\n\t\t\t\t.catch(err => {\r\n\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t});\r\n\t\t},\r\n\t\tgetCacheSize() {\r\n\t\t\tgetCacheSize().then((res: any) => {\r\n\t\t\t\tthis.cacheSize = parseInt(res);\r\n\t\t\t});\r\n\t\t},\r\n\t\tclean() {\r\n\t\t\tconst keepList = walk(\r\n\t\t\t\tthis.$store.state.danmakuProfile,\r\n\t\t\t\t(value: any) => {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\treturn path.extname(value);\r\n\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t\tremoveCache(uniq(keepList)).then(res => {\r\n\t\t\t\tthis.getCacheSize();\r\n\t\t\t});\r\n\t\t},\r\n\t\topenFolder() {\r\n\t\t\topenCache();\r\n\t\t}\r\n\t}\r\n});\r\n","import { render } from \"./index.vue?vue&type=template&id=05ab9488&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=ts\"\nexport * from \"./index.vue?vue&type=script&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=05ab9488&scoped=true&lang=scss\"\nscript.render = render\nscript.__scopeId = \"data-v-05ab9488\"\n\nexport default script","var baseUniq = require('./_baseUniq');\n\n/**\n * Creates a duplicate-free version of an array, using\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons, in which only the first occurrence of each element\n * is kept. The order of result values is determined by the order they occur\n * in the array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @returns {Array} Returns the new duplicate free array.\n * @example\n *\n * _.uniq([2, 1, 2]);\n * // => [2, 1]\n */\nfunction uniq(array) {\n  return (array && array.length) ? baseUniq(array) : [];\n}\n\nmodule.exports = uniq;\n"],"sourceRoot":""}